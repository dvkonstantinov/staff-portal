/*!
 * Tiny Spell Checker Pro plugin
 *
 * Copyright (c) 2022 Ephox Corporation DBA Tiny Technologies, Inc.
 * Licensed under the Tiny commercial license. See https://www.tiny.cloud/legal/
 *
 * Version: 3.1.1-313
 */

!function(){"use strict";const e=Object.getPrototypeOf,t=(e,t,n)=>{var r;return!!n(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},n=e=>n=>(e=>{const n=typeof e;return null===e?"null":"object"===n&&Array.isArray(e)?"array":"object"===n&&t(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":n})(n)===e,r=e=>t=>typeof t===e,o=e=>t=>e===t,s=n("string"),l=n("object"),a=n=>((n,r)=>l(n)&&t(n,r,((t,n)=>e(t)===n)))(n,Object),i=n("array"),c=o(null),u=r("boolean"),g=o(void 0),d=e=>null==e,m=e=>!d(e),p=r("function"),h=r("number"),f=(e,t)=>{if(i(e)){for(let n=0,r=e.length;n<r;++n)if(!t(e[n]))return!1;return!0}return!1},y=()=>{},b=(e,t)=>(...n)=>e(t.apply(null,n)),w=e=>()=>e,v=e=>e,x=(e,t)=>e===t;function k(e,...t){return(...n)=>{const r=t.concat(n);return e.apply(null,r)}}const T=e=>e(),S=e=>{e()},O=w(!1),E=w(!0);class C{constructor(e,t){this.tag=e,this.value=t}static some(e){return new C(!0,e)}static none(){return C.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?C.some(e(this.value)):C.none()}bind(e){return this.tag?e(this.value):C.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:C.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return m(e)?C.some(e):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}C.singletonNone=new C(!1);const _=Array.prototype.slice,A=Array.prototype.indexOf,N=Array.prototype.push,D=(e,t)=>A.call(e,t),I=(e,t)=>D(e,t)>-1,L=(e,t)=>{for(let n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1},R=(e,t)=>{const n=e.length,r=new Array(n);for(let o=0;o<n;o++){const n=e[o];r[o]=t(n,o)}return r},j=(e,t)=>{for(let n=0,r=e.length;n<r;n++)t(e[n],n)},M=(e,t)=>{const n=[];for(let r=0,o=e.length;r<o;r++){const o=e[r];t(o,r)&&n.push(o)}return n},B=(e,t,n)=>(j(e,((e,r)=>{n=t(n,e,r)})),n),P=(e,t)=>((e,t,n)=>{for(let r=0,o=e.length;r<o;r++){const o=e[r];if(t(o,r))return C.some(o);if(n(o,r))break}return C.none()})(e,t,O),z=(e,t)=>{for(let n=0,r=e.length;n<r;n++)if(t(e[n],n))return C.some(n);return C.none()},F=(e,t)=>(e=>{const t=[];for(let n=0,r=e.length;n<r;++n){if(!i(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);N.apply(t,e[n])}return t})(R(e,t)),q=(e,t)=>{for(let n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n))return!1;return!0},V=e=>{const t=_.call(e,0);return t.reverse(),t},W=e=>[e],U=(e,t)=>t>=0&&t<e.length?C.some(e[t]):C.none(),H=e=>U(e,0),J=Object.keys,$=Object.hasOwnProperty,K=(e,t)=>{const n=J(e);for(let r=0,o=n.length;r<o;r++){const o=n[r];t(e[o],o)}},G=(e,t)=>Z(e,((e,n)=>({k:n,v:t(e,n)}))),Z=(e,t)=>{const n={};return K(e,((e,r)=>{const o=t(e,r);n[o.k]=o.v})),n},Y=(e,t)=>{const n=[];return K(e,((e,r)=>{n.push(t(e,r))})),n},X=e=>Y(e,v),Q=(e,t)=>ee(e,t)?C.from(e[t]):C.none(),ee=(e,t)=>$.call(e,t),te="undefined"!=typeof window?window:Function("return this;")(),ne=(e,t)=>((e,t)=>{let n=null!=t?t:te;for(let t=0;t<e.length&&null!=n;++t)n=n[e[t]];return n})(e.split("."),t),re=Object.getPrototypeOf,oe=e=>{const t=ne("ownerDocument.defaultView",e);return l(e)&&((e=>((e,t)=>{const n=((e,t)=>ne(e,t))(e,t);if(null==n)throw new Error(e+" not available on this browser");return n})("HTMLElement",e))(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(re(e).constructor.name))},se=e=>e.dom.nodeName.toLowerCase(),le=e=>e.dom.nodeType,ae=e=>t=>le(t)===e,ie=e=>8===le(e)||"#comment"===se(e),ce=e=>ue(e)&&oe(e.dom),ue=ae(1),ge=ae(3),de=ae(9),me=ae(11),pe=e=>t=>ue(t)&&se(t)===e,he=(e,t,n)=>{if(!(s(n)||u(n)||h(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},fe=(e,t,n)=>{he(e.dom,t,n)},ye=(e,t)=>{const n=e.dom.getAttribute(t);return null===n?void 0:n},be=(e,t)=>C.from(ye(e,t)),we=(e,t)=>{e.dom.removeAttribute(t)},ve=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},xe={fromHtml:(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return ve(n.childNodes[0])},fromTag:(e,t)=>{const n=(t||document).createElement(e);return ve(n)},fromText:(e,t)=>{const n=(t||document).createTextNode(e);return ve(n)},fromDom:ve,fromPoint:(e,t,n)=>C.from(e.dom.elementFromPoint(t,n)).map(ve)},ke=e=>parseInt(e,10),Te=(e,t)=>{const n=e-t;return 0===n?0:n>0?1:-1},Se=(e,t,n)=>({major:e,minor:t,patch:n}),Oe=e=>{const t=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e);return t?Se(ke(t[1]),ke(t[2]),ke(t[3])):Se(0,0,0)},Ee=(e,t)=>{const n=e.dom;if(1!==n.nodeType)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Ce=(e,t)=>e.dom===t.dom,_e=Ee,Ae=(e,t,n=x)=>e.exists((e=>n(e,t))),Ne=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},De=(e,t,n)=>""===t||e.length>=t.length&&e.substr(n,n+t.length)===t,Ie=(e,t,n=0,r)=>{const o=e.indexOf(t,n);return-1!==o&&(!!g(r)||o+t.length<=r)},Le=(Re=/^\s+|\s+$/g,e=>e.replace(Re,""));var Re;const je=e=>void 0!==e.style&&p(e.style.getPropertyValue),Me=e=>xe.fromDom(e.dom.ownerDocument),Be=e=>de(e)?e:Me(e),Pe=e=>C.from(e.dom.parentNode).map(xe.fromDom),ze=(e,t)=>{const n=p(t)?t:O;let r=e.dom;const o=[];for(;null!==r.parentNode&&void 0!==r.parentNode;){const e=r.parentNode,t=xe.fromDom(e);if(o.push(t),!0===n(t))break;r=e}return o},Fe=e=>C.from(e.dom.previousSibling).map(xe.fromDom),qe=e=>C.from(e.dom.nextSibling).map(xe.fromDom),Ve=e=>R(e.dom.childNodes,xe.fromDom),We=(e,t)=>{const n=e.dom.childNodes;return C.from(n[t]).map(xe.fromDom)},Ue=e=>e.dom.childNodes.length,He=(e,t)=>({element:e,offset:t}),Je=p(Element.prototype.attachShadow)&&p(Node.prototype.getRootNode),$e=w(Je),Ke=Je?e=>xe.fromDom(e.dom.getRootNode()):Be,Ge=e=>xe.fromDom(e.dom.host),Ze=e=>{const t=ge(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const n=t.ownerDocument;return(e=>{const t=Ke(e);return me(n=t)&&m(n.dom.host)?C.some(t):C.none();var n})(xe.fromDom(t)).fold((()=>n.body.contains(t)),(r=Ze,o=Ge,e=>r(o(e))));var r,o},Ye=(e,t,n)=>{((e,t,n)=>{if(!s(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);je(e)&&e.style.setProperty(t,n)})(e.dom,t,n)},Xe=(e,t)=>{const n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||Ze(e)?r:Qe(n,t)},Qe=(e,t)=>je(e)?e.style.getPropertyValue(t):"",et=(e,t)=>{const n=e.dom,r=Qe(n,t);return C.from(r).filter((e=>e.length>0))},tt=(e,t)=>{((e,t)=>{je(e)&&e.style.removeProperty(t)})(e.dom,t),Ae(be(e,"style").map(Le),"")&&we(e,"style")},nt=(e,t)=>{Pe(e).each((n=>{n.dom.insertBefore(t.dom,e.dom)}))},rt=(e,t)=>{qe(e).fold((()=>{Pe(e).each((e=>{st(e,t)}))}),(e=>{nt(e,t)}))},ot=(e,t)=>{const n=(e=>We(e,0))(e);n.fold((()=>{st(e,t)}),(n=>{e.dom.insertBefore(t.dom,n.dom)}))},st=(e,t)=>{e.dom.appendChild(t.dom)},lt=(e,t)=>{nt(e,t),st(t,e)},at=(e,t)=>{j(t,((n,r)=>{const o=0===r?e:t[r-1];rt(o,n)}))},it=(e,t)=>{j(t,(t=>{st(e,t)}))},ct=(e,t)=>{let n=[];return j(Ve(e),(e=>{t(e)&&(n=n.concat([e])),n=n.concat(ct(e,t))})),n},ut=(e,t,n)=>{let r=e.dom;const o=p(n)?n:O;for(;r.parentNode;){r=r.parentNode;const e=xe.fromDom(r);if(t(e))return C.some(e);if(o(e))break}return C.none()},gt=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},dt=e=>{const t=Ve(e);t.length>0&&at(e,t),gt(e)},mt=(e,t)=>((e,t)=>{const n=void 0===t?document:t.dom;return 1!==(r=n).nodeType&&9!==r.nodeType&&11!==r.nodeType||0===r.childElementCount?[]:R(n.querySelectorAll(e),xe.fromDom);var r})(t,e),pt=(e,t,n)=>ut(e,(e=>Ee(e,t)),n),ht=(e,t,n)=>((e,t,n,r,o)=>((e,t)=>Ee(e,t))(n,r)?C.some(n):p(o)&&o(n)?C.none():t(n,r,o))(0,pt,e,t,n),ft=((e,t)=>{const n=t=>e(t)?C.from(t.dom.nodeValue):C.none();return{get:t=>{if(!e(t))throw new Error("Can only get text value of a text node");return n(t).getOr("")},getOption:n,set:(t,n)=>{if(!e(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=n}}})(ge),yt=e=>ft.get(e),bt=(e,t)=>ft.set(e,t);var wt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],vt=()=>({up:w({selector:pt,closest:ht,predicate:ut,all:ze}),down:w({selector:mt,predicate:ct}),styles:w({get:Xe,getRaw:et,set:Ye,remove:tt}),attrs:w({get:ye,set:fe,remove:we,copyTo:(e,t)=>{((e,t)=>{const n=e.dom;K(t,((e,t)=>{he(n,t,e)}))})(t,B(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}))}}),insert:w({before:nt,after:rt,afterAll:at,append:st,appendAll:it,prepend:ot,wrap:lt}),remove:w({unwrap:dt,remove:gt}),create:w({nu:xe.fromTag,clone:e=>xe.fromDom(e.dom.cloneNode(!1)),text:xe.fromText}),query:w({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:Fe,nextSibling:qe}),property:w({children:Ve,name:se,parent:Pe,document:e=>Be(e).dom,isText:ge,isComment:ie,isElement:ue,isSpecial:e=>{const t=se(e);return I(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>ue(e)?be(e,"lang"):C.none(),getText:yt,setText:bt,isBoundary:e=>!!ue(e)&&("body"===se(e)||I(wt,se(e))),isEmptyTag:e=>!!ue(e)&&I(["br","img","hr","input"],se(e)),isNonEditable:e=>ue(e)&&"false"===ye(e,"contenteditable")}),eq:Ce,is:_e});const xt=(e,t)=>({element:e,offset:t}),kt=(e,t,n)=>({element:e,start:t,finish:n}),Tt=e=>{if(!i(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],n={};return j(e,((r,o)=>{const s=J(r);if(1!==s.length)throw new Error("one and only one name per case");const l=s[0],a=r[l];if(void 0!==n[l])throw new Error("duplicate key detected:"+l);if("cata"===l)throw new Error("cannot have a case named cata (sorry)");if(!i(a))throw new Error("case arguments must be an array");t.push(l),n[l]=(...n)=>{const r=n.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+l+". Expected "+a.length+" ("+a+"), got "+r);return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:e=>{const r=J(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!q(t,(e=>I(r,e))))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[l].apply(null,n)},log:e=>{console.log(e,{constructors:t,constructor:l,params:n})}}}})),n},St=Tt([{before:["element"]},{after:["element"]},{rest:["element"]},{last:["element"]},{invalid:["element","offset"]}]);St.before,St.after,St.rest,St.last,St.invalid;const Ot=(e,t)=>z(e,(e=>e.start===t)),Et=(e,t,n=0)=>B(e,((e,n)=>t(n,e.len).fold(w(e),(t=>({len:t.finish,list:e.list.concat([t])})))),{len:n,list:[]}).list,Ct=(e,t,n)=>0===t.length?e:F(e,(e=>{const r=F(t,(t=>((e,t)=>t>=e.start&&t<=e.finish)(e,t)?[t-e.start]:[]));return r.length>0?((e,t,n)=>{return r=n(e,t),o=e.start,R(r,(e=>({...e,start:e.start+o,finish:e.finish+o})));var r,o})(e,r,n):[e]})),_t=Tt([{none:[]},{start:["element"]},{middle:["before","after"]},{end:["element"]}]);_t.none,_t.start,_t.middle,_t.end;const At=Tt([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}]),Nt={include:At.include,excludeWith:At.excludeWith,excludeWithout:At.excludeWithout,cata:(e,t,n,r)=>e.fold(t,n,r)},Dt=Tt([{boundary:["item","universe"]},{empty:["item","universe"]},{text:["item","universe"]},{nonEditable:["item","universe"]}]),It=O,Lt=E,Rt=w(0),jt=w(1),Mt=e=>({...e,isBoundary:()=>e.fold(Lt,It,It,It),toText:()=>e.fold(C.none,C.none,(e=>C.some(e)),C.none),is:t=>e.fold(It,It,((e,n)=>n.eq(e,t)),It),len:()=>e.fold(Rt,jt,((e,t)=>t.property().getText(e).length),jt)}),Bt={text:b(Mt,Dt.text),boundary:b(Mt,Dt.boundary),empty:b(Mt,Dt.empty),nonEditable:b(Mt,Dt.empty),cata:(e,t,n,r,o)=>e.fold(t,n,r,o)},Pt=w([]),zt=(e,t,n)=>{if(e.property().isText(t))return[Bt.text(t,e)];if(e.property().isEmptyTag(t))return[Bt.empty(t,e)];if(e.property().isNonEditable(t))return[];if(e.property().isElement(t)){const r=e.property().children(t),o=e.property().isBoundary(t)?[Bt.boundary(t,e)]:[],s=void 0!==n&&n(t)?[]:F(r,(t=>zt(e,t,n)));return o.concat(s).concat(o)}return[]},Ft=zt,qt=(e,t,n)=>{const r=((e,t)=>{const n=[];let r=[];return j(e,(e=>{const o=t(e);Nt.cata(o,(()=>{r.push(e)}),(()=>{r.length>0&&n.push(r),n.push([e]),r=[]}),(()=>{r.length>0&&n.push(r),r=[]}))})),r.length>0&&n.push(r),n})(F(t,(t=>Ft(e,t,n))),(e=>e.match({boundary:()=>Nt.excludeWithout(e),empty:()=>Nt.excludeWith(e),text:()=>Nt.include(e),nonEditable:()=>Nt.excludeWithout(e)})));return M(r,(e=>e.length>0))},Vt=(e,t)=>{if(e.property().isText(t))return xt(t,e.property().getText(t).length);{const n=e.property().children(t);return n.length>0?Vt(e,n[n.length-1]):xt(t,n.length)}},Wt=(e,t,n)=>{const r=e.property().children(t);return r.length>0&&n<r.length?Wt(e,r[n],0):r.length>0&&e.property().isElement(t)&&r.length===n?Vt(e,r[r.length-1]):xt(t,n)},Ut=vt(),Ht=(e,t)=>{const n=ye(e,t);return void 0===n||""===n?[]:n.split(" ")},Jt=e=>void 0!==e.dom.classList,$t=(e,t)=>{Jt(e)?e.dom.classList.add(t):((e,t)=>{((e,t,n)=>{const r=Ht(e,t).concat([n]);fe(e,t,r.join(" "))})(e,"class",t)})(e,t)},Kt=(e,t)=>{Jt(e)?e.dom.classList.remove(t):((e,t)=>{((e,t,n)=>{const r=M(Ht(e,t),(e=>e!==n));r.length>0?fe(e,t,r.join(" ")):we(e,t)})(e,"class",t)})(e,t),(e=>{const t=Jt(e)?e.dom.classList:(e=>Ht(e,"class"))(e);0===t.length&&we(e,"class")})(e)},Gt=Wt,Zt=(e,t)=>k(e.eq,t),Yt=(e,t)=>{const n=e.property();return n.getLanguage(t).orThunk((()=>((e,t)=>{for(let n=0;n<e.length;n++){const r=t(e[n],n);if(r.isSome())return r}return C.none()})(e.up().all(t,O),n.getLanguage)))},Xt=Yt,Qt=(e,t)=>({item:e,mode:t}),en=(e,t,n,r=tn)=>e.property().parent(t).map((e=>Qt(e,r))),tn=(e,t,n,r=nn)=>n.sibling(e,t).map((e=>Qt(e,r))),nn=(e,t,n,r=nn)=>{const o=e.property().children(t);return n.first(o).map((e=>Qt(e,r)))},rn=[{current:en,next:tn,fallback:C.none()},{current:tn,next:nn,fallback:C.some(en)},{current:nn,next:nn,fallback:C.some(tn)}],on=(e,t,n,r,o=rn)=>P(o,(e=>e.current===n)).bind((n=>n.current(e,t,r,n.next).orThunk((()=>n.fallback.bind((n=>on(e,t,n,r))))))),sn={left:()=>({sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?C.some(e[e.length-1]):C.none()}),right:()=>({sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?C.some(e[0]):C.none()})},ln=(e,t,n,r,o,s)=>on(e,t,r,o).bind((t=>s(t.item)?C.none():n(t.item)?C.some(t.item):ln(e,t.item,n,t.mode,o,s))),an=(e,t,n,r)=>ln(e,t,n,tn,sn.right(),r),cn=an,un=()=>({left:sn.left,right:sn.right}),gn=on,dn=(e,t,n,r)=>({item:e,start:t,finish:n,text:r}),mn=(e,t)=>({items:e,abort:t}),pn=(e,t)=>{const n=e.property().getText(t);return dn(t,0,n.length,n)},hn=(e,t,n)=>mn([],!0),fn=(e,t,n)=>mn([],!1),yn=(e,t,n)=>{const r=e.property().getText(t);return n(r).fold((()=>mn([dn(t,0,r.length,r)],!1)),(e=>{const n=e[0]===e[1]?[]:[dn(t,e[0],e[1],r.substring(e[0],e[1]))];return mn(n,!0)}))},bn=pn,wn=(e,t)=>e.property().isText(t)?pn(e,t):dn(t,0,0,""),vn=(e,t,n,r)=>(e.property().isBoundary(t)||e.property().isEmptyTag(t)||r(e,t)?hn:e.property().isText(t)?yn:fn)(e,t,n),xn=w("[^\\w'\\-\xad\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),kn=w("[\\w'\\-\xad\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),Tn=(e,t,n,r)=>({term:()=>new RegExp(e,r.getOr("g")),prefix:t,suffix:n}),Sn=Tn,On=xn,En=kn,Cn=(e,t)=>{const n=t.term(),r=[];let o=n.exec(e);for(;o;){const s=o.index+t.prefix(o),l=o[0].length-t.prefix(o)-t.suffix(o);r.push({start:s,finish:s+l}),n.lastIndex=s+l,o=n.exec(e)}return r},_n=Cn,An=new RegExp(On()+"+","g"),Nn=w(0),Dn=un(),In=Dn.left(),Ln=Dn.right(),Rn={left:{sibling:In.sibling,first:In.first,slicer:e=>(e=>{const t=_n(e,Sn(On(),Nn,Nn,C.none()));return C.from(t[t.length-1]).map((e=>e.start))})(e).map((t=>[t+1,e.length]))},right:{sibling:Ln.sibling,first:Ln.first,slicer:e=>(e=>{const t=e.search(An);return t>-1?C.some(t):C.none()})(e).map((e=>[0,e]))}},jn=(e,t,n,r,o)=>{const s=gn(e,t,n,r).map((t=>{const n=vn(e,t.item,r.slicer,o),s=n.abort?[]:jn(e,t.item,t.mode,r,o);return n.items.concat(s)})).getOr([]);return M(s,(e=>e.text.trim().length>0))},Mn=(e,t,n,r)=>{const o=((e,t,n)=>jn(e,t,tn,Rn.left,n))(e,t,r),s=((e,t,n)=>jn(e,t,tn,Rn.right,n))(e,n,r);return{left:o.length>0?o[o.length-1]:wn(e,t),right:s.length>0?s[s.length-1]:wn(e,n),isEmpty:0===o.length&&0===s.length}},Bn=(e,t,n)=>({word:e,left:t,right:n}),Pn=["'","\u2018","\u2019"],zn=F(Pn,(e=>R(["twas"],(t=>e+t)))),Fn=e=>I(Pn,e),qn=e=>{const t=(o=En()+"+",Tn(o,w(0),w(0),C.none())),n=_n(e,t),r=e.length;var o;return R(n,(t=>{const n=t.start,o=t.finish,s=e.substring(n,o),l=n>0?C.some(e.charAt(n-1)):C.none(),a=o<r?C.some(e.charAt(o)):C.none();return(e=>{const t=(e=>{const t=e.word;return t.length>=2&&Fn(t.charAt(t.length-1))&&!Fn(t.charAt(t.length-2))?(e=>{const t=e.word;return Bn(t.substring(0,t.length-1),e.left,C.some(t.charAt(t.length-1)))})(e):e})(e);return(e=>{const t=e.word,n=L(zn,(e=>t.indexOf(e)>-1))?2:1,r=t.substring(0,n);return q(r,Fn)&&!Fn(t.charAt(n))?(e=>{const t=e.word;return Bn(t.substring(1),C.some(t.charAt(0)),e.right)})(e):e})(t)})(Bn(s,l,a))}))},Vn={...Tt([{aboveView:["item"]},{inView:["item"]},{belowView:["item"]}]),cata:(e,t,n,r)=>e.fold(t,n,r)},Wn=(e,t,n)=>e.property().isSpecial(n.item)||e.property().isNonEditable(n.item)?C.some({item:n.item,mode:tn}):e.property().isBoundary(n.item)?Vn.cata(t.assess(n.item),(()=>n.mode!==en?C.some({item:n.item,mode:tn}):C.none()),(()=>C.some(n)),(()=>C.none())):C.some(n),Un=(e,t,n,r,o)=>{const s=e.property().getLanguage(o.item);e.property().isText(o.item)?t.addDetail(n(e,o.item)):e.property().isBoundary(o.item)?Vn.cata(r.assess(o.item),y,(()=>(o.mode===nn?t.openBoundary(s,o.item):t.closeBoundary(s,o.item),C.some(o))),y):e.property().isEmptyTag(o.item)?t.addEmpty(o.item):o.mode===nn?t.openInline(s,o.item):t.closeInline(s,o.item)},Hn=(e,t,n,r,o,s)=>(e.eq(t,n)?C.some(t):e.property().parent(t)).map((l=>{const a=Xt(e,l).getOr(r);return((e,t,n,r,o,s)=>{const l=t=>!e.eq(t.item,n)||t.mode===nn&&!e.property().isText(t.item)&&0!==e.property().children(t.item).length,a=(e=>{let t=[];const n=[];let r=[],o=e;const s=e=>{e.each((e=>{t.push(e)}))},l=e=>{e.each((e=>{t=t.slice(0,t.length-1)}))},a=()=>{r.length>0&&n.push({lang:o,details:r})},i=e=>{a(),r=[],o=e},c=n=>n.or(C.from(t[t.length-1])).getOr(e);return{openInline:(e,t)=>{const n=c(e);n!==o&&i(n),s(e)},closeInline:(e,t)=>{l(e)},addDetail:e=>{const t=c(C.none());t!==o&&i(t),r.push(e)},addEmpty:e=>{const t=c(C.none());i(t)},openBoundary:(e,t)=>{s(e);const n=c(e);i(n)},closeBoundary:(e,t)=>{l(e);const n=c(e);i(n)},done:()=>(a(),n.slice(0))}})(r);let i=C.some({item:t,mode:nn}).filter(l);for(;i.isSome();)i.each((t=>Un(e,a,o,s,t))),i=i.bind((t=>Wn(e,s,t))).filter(l).bind((t=>gn(e,t.item,t.mode,un().right()))).filter(l);return e.property().isText(n)&&a.addDetail(o(e,n)),a.done()})(e,t,n,a,o,s)})),Jn=(e,t,n,r,o,s)=>{const l=((e,t,n)=>{const r=((e,t,n,r=O)=>{const o=[t].concat(e.up().all(t)),s=[n].concat(e.up().all(n)),l=e=>z(e,r).fold((()=>e),(t=>e.slice(0,t+1))),a=l(o),i=l(s),c=P(a,(t=>L(i,Zt(e,t))));return{firstpath:a,secondpath:i,shared:c}})(e,t,n);return r.shared.bind((t=>((e,t,n,r)=>{const o=e.property().children(t);if(e.eq(t,n[0]))return C.some([n[0]]);if(e.eq(t,r[0]))return C.some([r[0]]);const s=n=>{const r=V(n),s=z(r,Zt(e,t)).getOr(-1),l=s<r.length-1?r[s+1]:r[s];return z(o,Zt(e,l))},l=s(n),a=s(r);return l.bind((e=>a.map((t=>{const n=Math.min(e,t),r=Math.max(e,t);return o.slice(n,r+1)}))))})(e,t,r.firstpath,r.secondpath)))})(e,t,n).bind((t=>{if(0===t.length)return C.none();const n=t[0],l=t[t.length-1];return Hn(e,n,l,r,o,s)})).getOr([]);return((e,t)=>{const n=R(t,(e=>{const t=e.details,n=e.lang,r=R(t,(e=>e.text)).join(""),o=R(t,(e=>e.item));return{lang:n,words:qn(r),elements:o}}));return{zones:n}})(0,l)},$n=(e,t)=>(n,r)=>n.eq(r,e.item)?e:n.eq(r,t.item)?t:bn(n,r),Kn=()=>({zones:[]}),Gn=(e,t,n,r)=>e.property().isBoundary(t)?((e,t,n,r,o)=>Jn(e,t,n,r,bn,o))(e,t,t,n,r):e.property().isEmptyTag(t)?Zn():((e,t,n,r)=>{const o=((e,t)=>{const n=Mn(e,t,t,O),r=n.isEmpty&&((e,t)=>!e.property().isText(t)&&0===e.down().predicate(t,e.property().isText).length)(e,t);return{left:n.left,right:n.right,isEmpty:r}})(e,t),s=$n(o.left,o.right);return o.isEmpty?Kn():Jn(e,o.left.item,o.right.item,n,s,r)})(e,t,n,r),Zn=Kn,Yn={af:"Afrikaans",af_za:"Afrikaans (South Africa)",ar:"Arabic",ca:"Catalan",cs:"Czech",da:"Danish",de:"German",el:"Greek",en:"English",en_au:"English (Australia)",en_br:"English (United Kingdom)",en_ca:"English (Canada)",en_gb:"English (United Kingdom)",en_gb_medical:"Medical English (UK)",en_uk:"English (United Kingdom)",en_us:"English (United States)",en_us_medical:"Medical English (US)",es:"Spanish",es_419:"Spanish (Latin America)",es_es:"Spanish (Spain)",fa:"Farsi",fi:"Finnish",fr:"French",fr_ca:"French (Canada)",he:"Hebrew",hr:"Croatian",hu:"Hungarian",it:"Italian",ja:"Japanese",kk:"Kazakh",ko:"Korean",mi_nz:"Maori (New Zealand)",nb:"Norwegian Bokm\xe5l",nl:"Dutch",nn:"Norwegian Nynorsk",no:"Norwegian",pl:"Polish",pt:"Portuguese",pt_br:"Portuguese (Brazil)",pt_pt:"Portuguese (Portugal)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",sv:"Swedish",sv_fi:"Swedish (Finland)",th:"Thai",tr:"Turkish",tt:"Tatar",uk:"Ukrainian",zh:"Chinese",zh_cn:"Chinese (Simplified)",zh_tw:"Chinese (Traditional)"},Xn=e=>e.replace(/-/g,"_").toLowerCase(),Qn=e=>Q(Yn,Xn(e)).getOrThunk((()=>e.toUpperCase())),er=e=>(t,n)=>ht(t,"[lang]",e).map((e=>{const t=be(e,"data-mce-lang").getOrThunk((()=>ye(e,"lang"))),r=Xn(t);return g(n)||ee(n,r)||(n[r]=Qn(r)),r})),tr=(e=>{let t,n=!1;return(...r)=>(n||(n=!0,t=e.apply(null,r)),t)})((()=>new RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$"))),nr=e=>{return C.from((t=e,t.dom.textContent)).exists((e=>{const t=e.trim().replace(/[\u200B\uFEFF]/g,"");return tr().test(t)}));var t},rr=vt(),or=rr.property(),sr=e=>({...rr,property:w({...or,getLanguage:er(e)})}),lr=()=>Zn(),ar={assess:Vn.inView},ir={anything:w(ar)},cr=(e,t,n,r,o,s)=>{const l=Jn(e,t,n,r,s,ir.anything()).zones;return 1===l.length?((e,t)=>e.lang===t?C.some(e):C.none())(l[0],o):C.none()},ur=(e,t,n,r,o)=>cr(e,t,n,r,o,bn),gr=(e,t,n,r)=>e.property().isBoundary(t)?ur(e,t,t,n,r):e.property().isEmptyTag(t)?C.none():((e,t,n,r)=>{const o=((e,t)=>(n,r)=>{const o=Yt(n,r).getOr(e);return t!==o})(n,r),s=Mn(e,t,t,o),l=$n(s.left,s.right);return s.isEmpty?((e,t,n,r)=>{const o=e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,s=Gt(e,t,0),l=Gt(e,t,o);return ur(e,s.element,l.element,n,r)})(e,t,n,r):cr(e,s.left.item,s.right.item,n,r,l)})(e,t,n,r),dr=vt(),mr=e=>F(e,(e=>ct(e,ge))),pr=e=>F(e,Ve),hr=e=>{const t=fr(e);return{resolve:e=>{const n=e.split(" ");return R(n,(e=>yr(t,e))).join(" ")}}},fr=e=>e.replace(/\./g,"-"),yr=(e,t)=>e+"-"+t,br=hr("data.mce").resolve,wr=br("annotation"),vr=br("highlight-id"),xr=br("lingo"),kr=(e,t)=>ht(e,"."+t),Tr=e=>C.from(ye(e,vr)),Sr=e=>Tr(e).fold(w([e]),(t=>{const n=Me(e);return mt(n,"."+t)})),Or=e=>{const t=(e=>C.from(ye(e,wr)))(e),n=ye(e,xr);return t.fold(w([e]),(t=>Er(Me(e),t,n)))},Er=(e,t,n)=>{const r=mt(e,`span[${wr}]`);return M(r,(e=>{const r=!m(n)||ye(e,xr)===n;return ye(e,wr)===t&&r}))},Cr=w(wr),_r=hr("mce").resolve,Ar=br("lingo"),Nr=_r("spellchecker-annotation"),Dr=_r("spellchecker-word"),Ir=_r("spellchecker-ignore"),Lr=_r("spellchecker-current"),Rr=(e,t)=>C.from(ye(e,t)),jr={nu:()=>{const e=xe.fromTag("span");var t;return t=e,j([Nr,Dr],(e=>{$t(t,e)})),fe(e,"aria-invalid","spelling"),(e=>((e,t)=>({element:t,wrap:n=>{e.insert().append(t,n)}}))(Ut,e))(e)},set:(e,t,n)=>{fe(e,"data-mce-bogus",1),fe(e,Cr(),n),fe(e,Ar,t)},setCurrent:e=>{$t(e,Lr)},unSetCurrent:e=>{Kt(e,Lr)},label:w(Nr),wordLabel:w(Dr),ignoreLabel:w(Ir),currentLabel:w(Lr),detail:e=>Tr(e).bind((t=>Rr(e,Cr()).bind((n=>Rr(e,Ar).map((r=>({id:t,word:n,lang:r,element:e})))))))},Mr=e=>({fold:(t,n)=>n(e)}),Br=_r("wrap-disabled"),Pr=e=>{const t=Sr(e);j(t,(e=>{Kt(e,Br)}))};let zr=0;const Fr=e=>{const t=(new Date).getTime(),n=Math.floor(1e9*Math.random());return zr++,e+"_"+n+zr+String(t)},qr=(e,t,n)=>{const r=F(n,(e=>[e.start,e.finish])),o=Ct(t,r,((t,n)=>((e,t,n)=>{const r=e.property().getText(t),o=M(((e,t)=>{if(0===t.length)return[e];const n=B(t,((t,n)=>{if(0===n)return t;const r=e.substring(t.prev,n);return{prev:n,values:t.values.concat([r])}}),{prev:0,values:[]}),r=t[t.length-1];return r<e.length?n.values.concat(e.substring(r)):n.values})(r,n),(e=>e.length>0));if(o.length<=1)return[kt(t,0,r.length)];e.property().setText(t,o[0]);const s=Et(o.slice(1),((t,n)=>{const r=e.create().text(t),o=kt(r,n,n+t.length);return C.some(o)}),o[0].length),l=R(s,(e=>e.element));return e.insert().afterAll(t,l),[kt(t,0,o[0].length)].concat(s)})(e,t.element,n)));return R(n,(t=>{const n=((e,t,n)=>{const r=Ot(e,t),o=Ot(e,n);return r.bind((t=>{const r=o.getOr(((e,t)=>e[e.length-1]&&e[e.length-1].finish===t?e.length+1:-1)(e,n));return r>-1?C.some(e.slice(t,r)):C.none()})).getOr([])})(o,t.start,t.finish),r=R(n,(e=>e.element)),s=R(r,e.property().getText).join("");return{elements:r,word:t.word,exact:s}}))},Vr=(e,t,n,r)=>{const o=qt(e,t,r),s=F(o,(t=>{const r=F(t,(e=>e.fold(Pt,Pt,(e=>[e]),Pt))),o=((e,t)=>{const n=F(t,(t=>{const n=Cn(e,t.pattern);return R(n,(e=>({...t,...e})))}));return(e=>{const t=Array.prototype.slice.call(e,0);return t.sort(((e,t)=>e.start<t.start?-1:t.start<e.start?1:0)),t})(n)})(R(r,e.property().getText).join(""),n),s=((e,t)=>Et(t,((t,n)=>{const r=n+e.property().getText(t).length;return C.from(kt(t,n,r))})))(e,r);return qr(e,s,o)}));return s},Wr=(e,t,n,r)=>{const o=R(n,(e=>((e,t)=>({word:e,pattern:t}))(e,(e=>{const t="((?:^'?)|(?:"+xn()+"+'?))"+e+"((?:'?$)|(?:'?"+xn()+"+))";return Tn(t,(e=>e.length>1?e[1].length:0),(e=>e.length>2?e[2].length:0),C.none())})(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")))));return Vr(e,t,o,r)},Ur=vt(),Hr=(e,t,n,r)=>{if(L(e,(e=>pt(e,"a").exists(nr))))return!1;{const o=(e=>{const t=mr(e);return R(t,(e=>ge(e)?yt(e):"")).join("")})(e),s=((e,t,n)=>C.from(e[0]).bind((e=>{const r=((e,t,n)=>gr(dr,e,t,n))(e,t,n);return r.bind((e=>{const t=e.words;return 1===t.length?C.some(t[0].word):C.none()}))})))(e,n,r);return o===t&&Ae(s,t)}},Jr=(e,t,n,r,o)=>{const s=((e,t)=>{const n={};return j(e,(e=>{kr(e,t.label()).filter(Ze).each((e=>{t.detail(e).each((t=>{const{id:r,word:o,lang:s}=t,l=Sr(e);l.length>0&&(n[r]=((e,t,n,r)=>({id:e,elements:t,word:n,lang:r}))(r,l,o,s))}))}))})),n})(e.elements,t),l=((e,t,n)=>{const r=X(e);return R(r,(e=>{return e.lang===n&&Hr(e.elements,e.word,t,e.lang)?(r=e,{fold:(e,t)=>t(r)}):(e=>({fold:(t,n)=>t(e)}))(e);var r}))})(s,o,e.lang);j(l,(e=>{const t=e=>t=>{j(t.elements,e)};e.fold(t(r),t(n))}))},$r=(e,t,n,r)=>{Jr(t,jr,Pr,dt,e.lang());const o=((e,t,n)=>((e,t,n)=>Wr(Ur,e,t,n))(e,t,n))(t.elements,n,r),s=((e,t)=>R(e,(e=>((e,t)=>{const n=F(e.elements,(e=>kr(e,t).fold(w([]),W)));return((e,t,n)=>({id:e,match:t,current:n}))(Fr("mce-cram"),e,C.from(n[0]))})(e,t))))(o,jr.label());return F(s,(n=>n.current.fold((()=>{const r=n.match,o=r.word;if(e.ignore(r))return[];const s=((e,t)=>((e,t,n)=>{if(0===t.length)return t;const r=M(t,(t=>e.property().isText(t)&&e.property().getText(t).length>0));return R(r,(t=>{const r=n();return e.insert().before(t,r.element),r.wrap(t),r.element}))})(Ut,e,t))(M(r.elements,(e=>(ce(e)?C.some(e):Pe(e).filter(ce)).exists((e=>"false"!==e.dom.contentEditable&&!ht(e,"a").exists(nr))))),jr.nu)||[];return j(s,(e=>{var r,s;r=e,s=n.id,fe(r,vr,s),$t(r,s),jr.set(e,t.lang,o)})),s.length>0?[Mr(s)]:[]}),(e=>{return[(t=e,{fold:(e,n)=>e(t)})];var t}))))},Kr=e=>((e,t,n)=>ht(e,"."+t+":not(."+n+")"))(e,jr.label(),jr.ignoreLabel()),Gr=e=>((e,t,n)=>R(e.dom.select("."+t+":not(."+n+")"),xe.fromDom))(e,jr.label(),jr.ignoreLabel()),Zr=e=>jr.detail(e),Yr=jr.label,Xr="no.language",Qr=e=>e!==Xr,eo=w(Xr),to=e=>e.dispatch("SpellcheckStart"),no=e=>e.dispatch("SpellcheckEnd"),ro=(e,t,n)=>e.dispatch("SpellcheckerLanguageChanged",{language:t,prevLanguage:n}),oo=e=>{const t={};return j(e,(e=>{t[e]={}})),J(t)},so=()=>(new Date).getTime(),lo=(e,t=36e5)=>{const n={},r=(e,t,r)=>{n[e]={result:t,timestamp:r}},o=(e,n)=>e-n<t,s=w(n);return l(e)&&(e=>{const t=so();K(e,((e,n)=>{o(t,e.timestamp)&&r(n,e.result,e.timestamp)}))})(e),{set:r,get:(e,t)=>C.from(n[t]).filter((t=>o(e,t.timestamp))).map((e=>e.result)),dump:s}};var ao;!function(e){e.JSON="json",e.Blob="blob",e.Text="text",e.FormData="formdata",e.MultipartFormData="multipart/form-data"}(ao||(ao={}));const io=e=>{let t=C.none(),n=[];const r=e=>{o()?s(e):n.push(e)},o=()=>t.isSome(),s=e=>{t.each((t=>{setTimeout((()=>{e(t)}),0)}))};return e((e=>{o()||(t=C.some(e),j(n,s),n=[])})),{get:r,map:e=>io((t=>{r((n=>{t(e(n))}))})),isReady:o}},co={nu:io,pure:e=>io((t=>{t(e)}))},uo=e=>{setTimeout((()=>{throw e}),0)},go=e=>{const t=t=>{e().then(t,uo)};return{map:t=>go((()=>e().then(t))),bind:t=>go((()=>e().then((e=>t(e).toPromise())))),anonBind:t=>go((()=>e().then((()=>t.toPromise())))),toLazy:()=>co.nu(t),toCached:()=>{let t=null;return go((()=>(null===t&&(t=e()),t)))},toPromise:e,get:t}},mo=e=>go((()=>new Promise(e))),po=e=>go((()=>Promise.resolve(e))),ho=e=>{const t=t=>t(e),n=w(e),r=()=>o,o={tag:!0,inner:e,fold:(t,n)=>n(e),isValue:E,isError:O,map:t=>yo.value(t(e)),mapError:r,bind:t,exists:t,forall:t,getOr:n,or:r,getOrThunk:n,orThunk:r,getOrDie:n,each:t=>{t(e)},toOptional:()=>C.some(e)};return o},fo=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(t,n)=>t(e),isValue:O,isError:E,map:t,mapError:t=>yo.error(t(e)),bind:t,exists:O,forall:E,getOr:v,or:v,getOrThunk:T,orThunk:T,getOrDie:(r=String(e),()=>{throw new Error(r)}),each:y,toOptional:C.none};var r;return n},yo={value:ho,error:fo,fromOption:(e,t)=>e.fold((()=>fo(t)),ho)},bo=e=>({...e,toCached:()=>bo(e.toCached()),bindFuture:t=>bo(e.bind((e=>e.fold((e=>po(yo.error(e))),(e=>t(e)))))),bindResult:t=>bo(e.map((e=>e.bind(t)))),mapResult:t=>bo(e.map((e=>e.map(t)))),mapError:t=>bo(e.map((e=>e.mapError(t)))),foldResult:(t,n)=>e.map((e=>e.fold(t,n))),withTimeout:(t,n)=>bo(mo((r=>{let o=!1;const s=setTimeout((()=>{o=!0,r(yo.error(n()))}),t);e.get((e=>{o||(clearTimeout(s),r(e))}))})))}),wo=e=>bo(mo(e)),vo=e=>bo(po(yo.value(e))),xo={nu:wo,wrap:bo,pure:vo,value:vo,error:e=>bo(po(yo.error(e))),fromResult:e=>bo(po(e)),fromFuture:e=>bo(e.map(yo.value)),fromPromise:e=>wo((t=>{e.then((e=>{t(yo.value(e))}),(e=>{t(yo.error(e))}))}))},ko=e=>mo((t=>{const n=new FileReader;n.onload=e=>{const n=e.target?e.target.result:"";t(n)},n.readAsText(e)})),To=e=>{try{const t=JSON.parse(e);return yo.value(t)}catch(e){return yo.error("Response was not JSON.")}},So=e=>po(e.response),Oo=e=>xo.nu((t=>{const n=new XMLHttpRequest;var r;n.open(e.method,(r=e.url,C.from(e.query).map((e=>{const t=Y(e,((e,t)=>encodeURIComponent(t)+"="+encodeURIComponent(e))),n=Ie(r,"?")?"&":"?";return t.length>0?r+n+t.join("&"):r})).getOr(r)),!0);const o=(e=>{const t=(n=e.body,C.from(n).bind((e=>{switch(e.type){case ao.JSON:return C.some("application/json");case ao.FormData:return C.some("application/x-www-form-urlencoded; charset=UTF-8");case ao.MultipartFormData:return C.none();case ao.Text:default:return C.some("text/plain")}})));var n;const r=!0===e.credentials?C.some(!0):C.none(),o=(e=>{switch(e){case ao.Blob:return"application/octet-stream";case ao.JSON:return"application/json, text/javascript";case ao.Text:return"text/plain";default:return""}})(e.responseType)+", */*; q=0.01",s=void 0!==e.headers?e.headers:{};return{contentType:t,responseType:(e=>{switch(e){case ao.JSON:return C.none();case ao.Blob:return C.some("blob");case ao.Text:return C.some("text");default:return C.none()}})(e.responseType),credentials:r,accept:o,headers:s,progress:p(e.progress)?C.some(e.progress):C.none()}})(e);((e,t)=>{t.contentType.each((t=>e.setRequestHeader("Content-Type",t))),e.setRequestHeader("Accept",t.accept),t.credentials.each((t=>e.withCredentials=t)),t.responseType.each((t=>e.responseType=t)),t.progress.each((t=>e.upload.addEventListener("progress",(e=>t(e.loaded,e.total))))),K(t.headers,((t,n)=>e.setRequestHeader(n,t)))})(n,o);const s=()=>{((e,t,n)=>((e,t)=>{switch(e){case ao.JSON:return To(t.response).fold((()=>So(t)),po);case ao.Blob:return(e=>C.from(e.response).map(ko).getOr(po("no response content")))(t);case ao.Text:default:return So(t)}})(t,n).map((t=>({message:0===n.status?"Unknown HTTP error (possible cross-domain request)":`Could not load url ${e}: ${n.statusText}`,status:n.status,responseText:t}))))(e.url,e.responseType,n).get((e=>t(yo.error(e))))};var l;n.onerror=s,n.onload=()=>{var r;0!==n.status||(r=e.url,De(r,"file:",0))?n.status<100||n.status>=400?s():((e,t)=>{const n=e=>xo.error({message:e,status:t.status,responseText:t.responseText});switch(e){case ao.JSON:return To(t.response).fold(n,xo.pure);case ao.Blob:case ao.Text:return xo.pure(t.response);default:return n("unknown data type")}})(e.responseType,n).get(t):s()},(l=e.body,C.from(l).map((e=>e.type===ao.JSON?JSON.stringify(e.data):e.type===ao.FormData||e.type===ao.MultipartFormData?(e=>{const t=new FormData;return K(e,((e,n)=>{t.append(n,e)})),t})(e.data):e.data))).fold((()=>n.send()),(e=>{n.send(e)}))})),Eo=e=>({tag:1,error:e}),Co=(e,t)=>{const n=-1===e.indexOf("?")?"?":"&";return t?e+n+"apiKey="+encodeURIComponent(t):e},_o=e=>{const t=e.responseText;return l(t)?t:e.message},Ao=(e,t,n=_o)=>{const r=(e=>Q(e,"tiny-api-key").orThunk((()=>Q(e,"tinymce-api-key"))).orThunk((()=>Q(e,"textbox-api-key"))).getOrUndefined())(t);return{execute:o=>{const s=(l={url:Co(e,r),body:(a=o,{type:ao.JSON,data:a}),responseType:ao.JSON,credentials:!0,headers:t},Oo({...l,method:"post"})).mapError(n);var l,a;return xo.wrap(s)},cancelCurrent:y}},No=(e,t)=>{const n=[];return{execute:r=>(0===e?xo.nu((e=>{n.push({resume:()=>e(yo.value(void 0)),reject:()=>e(yo.error({tag:0}))})})):(e-=1,xo.pure(void 0))).bindFuture((()=>t.execute(r).map((t=>(C.from(n.shift()).fold((()=>e+=1),(e=>setTimeout(e.resume,0))),t.mapError(Eo)))))),cancelCurrent:()=>{for(var e;n.length;)null===(e=n.pop())||void 0===e||e.reject()}}};var Do;!function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"}(Do||(Do={}));const Io=(e,t,n)=>e.stype===Do.Error?t(e.serror):n(e.svalue),Lo=e=>({stype:Do.Value,svalue:e}),Ro=e=>({stype:Do.Error,serror:e}),jo=Io,Mo=e=>l(e)&&J(e).length>100?" removed due to size":JSON.stringify(e,null,2),Bo=(e,t)=>Ro([{path:e,getErrorInfo:t}]),Po=e=>(...t)=>{if(0===t.length)throw new Error("Can't merge zero objects");const n={};for(let r=0;r<t.length;r++){const o=t[r];for(const t in o)ee(o,t)&&(n[t]=e(n[t],o[t]))}return n},zo=Po(((e,t)=>a(e)&&a(t)?zo(e,t):t)),Fo=Po(((e,t)=>t)),qo=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},Vo=(Wo=Lo,{extract:(e,t)=>{return n=Wo(t),r=t=>((e,t)=>Bo(e,w(t)))(e,t),n.stype===Do.Error?r(n.serror):n;var n,r},toString:w("val")});var Wo;const Uo=(e,t,n,r)=>r(Q(e,t).getOrThunk((()=>n(e)))),Ho=(e,t,n,r,o)=>{const s=e=>o.extract(t.concat([r]),e),l=e=>e.fold((()=>Lo(C.none())),(e=>{const n=o.extract(t.concat([r]),e);return s=n,l=C.some,s.stype===Do.Value?{stype:Do.Value,svalue:l(s.svalue)}:s;var s,l}));switch(e.tag){case"required":return((e,t,n,r)=>Q(t,n).fold((()=>((e,t,n)=>Bo(e,(()=>'Could not find valid *required* value for "'+t+'" in '+Mo(n))))(e,n,t)),r))(t,n,r,s);case"defaultedThunk":return Uo(n,r,e.process,s);case"option":return((e,t,n)=>n(Q(e,t)))(n,r,l);case"defaultedOptionThunk":return((e,t,n,r)=>r(Q(e,t).map((t=>!0===t?n(e):t))))(n,r,e.process,l);case"mergeWithThunk":return Uo(n,r,w({}),(t=>{const r=zo(e.process(n),t);return s(r)}))}},Jo=(e,t,n)=>{return r=((e,t,n)=>((e,t)=>e.stype===Do.Error?{stype:Do.Error,serror:t(e.serror)}:e)(t.extract([e],n),(e=>({input:n,errors:e}))))(e,t,n),Io(r,yo.error,yo.value);var r},$o=e=>"Errors: \n"+(e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:w("... (only showing first ten failures)")}]):e;return R(t,(e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()))})(e.errors).join("\n")+"\n\nInput object: "+Mo(e.input),Ko=e=>((e,t)=>t((t=>{const n=[];let r=0;0===e.length?t([]):j(e,((o,s)=>{o.get((o=>s=>{n[o]=s,r++,r>=e.length&&t(n)})(s))}))})))(e,mo);Tt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const Go=(e,t,n,r,o,s)=>{const l=((e,t,n,r,o)=>o?{known:{},unknown:n}:B(n,((n,o)=>{const s=r(o);return e(t,s).fold((()=>({known:n.known,unknown:n.unknown.concat([o])})),(e=>{const t=((e,t)=>((e,t)=>({[e]:t}))(e,t))(s,e);return{known:{...n.known,...t},unknown:n.unknown}}))}),{known:{},unknown:[]}))(t.get,o,n,r,s);return 0===l.unknown.length?xo.value(l.known):((e,t,n,r,o,s)=>e(r,s).mapResult((e=>(K(e,((e,n)=>{t.set(n,e,o)})),{...n,...e}))))(e,t,l.known,l.unknown,o,s)},Zo=w(Vo),Yo=e=>((e,t,n,r)=>({tag:"field",key:e,newKey:t,presence:n,prop:r}))(e,e,{tag:"required",process:{}},Zo()),Xo=(e=>({extract:(t,n)=>((e,t,n)=>{const r={},o=[];for(const s of n)qo(s,((n,s,l,a)=>{const i=Ho(l,e,t,n,a);jo(i,(e=>{o.push(...e)}),(e=>{r[s]=e}))}),((e,n)=>{r[e]=n(t)}));return o.length>0?Ro(o):Lo(r)})(t,n,e),toString:()=>{const t=R(e,(e=>qo(e,((e,t,n,r)=>e+" -> "+r.toString()),((e,t)=>"state("+e+")"))));return"obj{\n"+t.join("\n")+"}"}}))([Yo("language"),Yo("words")]),Qo=(e,t,n,r,o)=>{const s=((e,t)=>{const n=[];for(let r=0;r<e.length;r+=t){const o=_.call(e,r,r+t);n.push(o)}return n})(r,o),l=R(s,(t=>{const r=((e,t,n)=>Jo(e,t,n).fold((e=>{throw new Error($o(e))}),v))("ephox.spelling.service.many.ajax.service.get",Xo,{language:n,words:t});return e.execute(r)})),a=Ko(l).map((e=>{const n=(e=>{const t=[],n=[];return j(e,(e=>{e.fold((e=>{t.push(e)}),(e=>{n.push(e)}))})),{errors:t,values:n}})(e);if(n.values.length>0){const e=R(n.values,t),r=B(e,Fo,{});return yo.value(r)}{const e=(e=>{const t=M(e,(e=>1===e.tag));return R(t,(e=>e.error))})(n.errors);return 0===e.length?yo.value({}):yo.error(e)}}));return xo.wrap(a)},es=(e={})=>{const t={};return K(e,((e,n)=>{t[n]=lo(e)})),t},ts=Fr("good-spelling"),ns=(e,t)=>Q(e,t).getOrThunk((()=>lo())),rs=e=>oo(e).sort(),os=e=>{const t=e.responseText,n=l(t)?t:{error:{data:null,message:e.message,type:"Unknown"}};return{status:e.status,...n}},ss={chunkSize:1500,maxRetries:3,maxInFlight:8},ls=(e,t,n,r=ss)=>{var o;e=((e,t)=>De(e,t,e.length-t.length))(o=e,"/")?((e,t)=>e.substring(0,e.length-t))(o,"/".length):o;const s=es(n),l=es({}),a=e=>{const t=((e,t)=>({execute:e=>{let n=0;const o=()=>(n++,t.execute(e).bind(s)),s=e=>e.fold((e=>((e,t)=>!(t>=r.maxRetries)&&(e.status<400||e.status>=500))(e,n)?o():xo.error(e)),xo.pure);return xo.wrap(o())},cancelCurrent:t.cancelCurrent}))(0,e);return No(r.maxInFlight,t)},i=a(Ao(e+"/2/check",t,os)),c=a(Ao(e+"/2/suggestions",t,os));return{check:(e,t)=>{const n=rs(t),o=so(),a=ns(l,e),c=ns(s,e);return l[e]=a,s[e]=c,((e,t,n,r,o,s,l,a)=>{const i=e=>e.check;return Go(((t,n)=>Qo(e,i,r,t,l)),n,o,v,s,!1).mapResult((e=>{const n={};return K(e,((e,r)=>{e?t.set(r,ts,s):n[r]=!1})),n}))})(i,c,a,e,n,o,r.chunkSize)},suggestions:(e,t)=>{const n=rs(t),o=so(),l=ns(s,e);return s[e]=l,((e,t,n,r,o,s,l)=>{const a=e=>e.spell;return Go(((t,r)=>Qo(e,a,n,t,s)),t,r,v,o,!1).mapResult((e=>{j(r,(n=>{ee(e,n)||t.set(n,ts,o)}));const n={};return K(e,((e,r)=>{t.get(o,r).each((t=>{t!==ts&&(n[r]=e)}))})),n}))})(c,l,e,n,o,r.chunkSize)},cancelCurrent:()=>{i.cancelCurrent(),c.cancelCurrent()},dumpCache:()=>G(s,(e=>e.dump()))}},as=[{value:"no.language",text:"Off"}],is=e=>t=>t.options.get(e),cs=is("spellchecker_dialog"),us=is("spellchecker_language"),gs=is("spellchecker_ignore_list"),ds=is("spellchecker_handler"),ms=is("spellchecker_rpc_url"),ps=is("spellchecker_active"),hs=e=>{const t=new RegExp("\ufeff","g"),n=new RegExp("[\u2018\u2019]","g");return e.replace(t,"").replace(n,"'")},fs=(e,t)=>({suggestions:e,ignore:t}),ys=e=>{const t=new Set;return j(e,(e=>t.add(e))),t},bs=vt(),ws=(e,t)=>Gt(bs,e,t),vs=e=>!e.inline&&e.hasPlugin("autoresize"),xs=e=>!e.inline&&!vs(e),ks=(e,t)=>e+t.top,Ts=e=>e.dom.getBoundingClientRect(),Ss=e=>{const t=xe.fromDom(e.startContainer),n=xe.fromDom(e.endContainer);return Os(t,e.startOffset,n,e.endOffset)},Os=(e,t,n,r)=>({startContainer:e,startOffset:t,endContainer:n,endOffset:r,collapsed:Ce(e,n)&&t===r}),Es=pe("img"),Cs=e=>e.filter((e=>!e.collapsed)).bind((e=>(e=>{const t=e.startContainer;if(!Ce(t,e.endContainer))return C.none();if(Es(t))return C.some(t);const n=Math.min(e.startOffset,e.endOffset),r=Math.max(e.startOffset,e.endOffset),o=We(t,n).filter(Es);return r===n||r===n+1?o:C.none()})(e).orThunk((()=>(e=>{const t=We(e.startContainer,e.startOffset).filter(Es);return(e=>qe(e.startContainer).filter(pe("img")))(e).or(t).bind((n=>(e=>Fe(e.endContainer).filter(pe("img")))(e).bind((r=>{const o=Ce(n,r),s=Ue(e.startContainer)===e.startOffset,l=0===e.endOffset;return o&&(s||t.isSome())&&l?C.some(n):C.none()}))))})(e))))),_s=(e,t,n)=>{const r=xt(t,n);return ee(e.getVoidElements(),se(t))?(o=Pe(t),a=t,s=Pe(a).bind((e=>{const t=Ve(e);return z(t,(e=>Ce(a,e)))})),l=(e,t)=>xt(e,0===n?t:t+1),o.isSome()&&s.isSome()?C.some(l(o.getOrDie(),s.getOrDie())):C.none()).getOr(r):r;var o,s,l,a},As=e=>Ss(e.selection.getRng()),Ns=e=>e.slice(0).sort(),Ds=(e,t)=>{const n=M(t,(t=>!I(e,t)));n.length>0&&(e=>{throw new Error("Unsupported keys for object: "+Ns(e).join(", "))})(n)},Is=(e,t)=>((e,t)=>({ch:e,offset:t}))(e.charAt(t),t),Ls=e=>m(e)&&void 0!==e.index&&e.index>=0?C.some(e.index):C.none(),Rs=un().left(),js=un().right(),Ms=Tt([{abort:[]},{kontinue:[]},{finish:["info"]}]),Bs=Tt([{aborted:[]},{edge:["element"]},{success:["info"]}]),Ps=(e,t)=>((e,t)=>I(["br","img","hr","input"],e.property().name(t)))(e,t)||e.property().isBoundary(t),zs=(e,t,n,r,o,s,l)=>{const a=()=>l.fold(Bs.aborted,Bs.edge),i=r=>gn(e,t,n,s).fold(a,(t=>zs(e,t.item,t.mode,C.none(),o,s,r)));if(Ps(e,t))return a();if(e.property().isText(t)){const n=e.property().getText(t);return o(e,Ms,t,n,r).fold(a,(()=>i(C.some(t))),Bs.success)}return i(l)},Fs=(e,t,n)=>{const r=t=>Ps(e,t);return((e,t,n,r)=>{const o=Gt(e,t,n);return e.property().isText(t)?C.none():((e,t,n,r)=>ln(e,t,n,tn,sn.left(),r))(e,o.element,e.property().isText,r).map((t=>xt(t,e.property().getText(t).length)))})(e,t,n,r).orThunk((()=>((e,t,n,r)=>{const o=Gt(e,t,n);return e.property().isText(t)?C.none():an(e,o.element,e.property().isText,r).map((e=>xt(e,0)))})(e,t,n,r))).getOr(xt(t,n))},qs=((e,t)=>((e,t,n)=>{if(0===t.length)throw new Error("You must specify at least one required field.");return((e,t)=>{if(!i(t))throw new Error("The required fields must be an array. Was: "+t+".");j(t,(t=>{if(!s(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))})("required",t),(e=>{const t=Ns(e);P(t,((e,n)=>n<t.length-1&&e===t[n+1])).each((e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))})(t),r=>{const o=J(r);q(t,(e=>I(o,e)))||((e,t)=>{throw new Error("All required keys ("+Ns(e).join(", ")+") were not specified. Specified keys were: "+Ns(t).join(", ")+".")})(t,o),e(t,o);const s=M(t,(e=>!n.validate(r[e],e)));return s.length>0&&((e,t)=>{throw new Error("All values need to be of type: "+t+". Keys ("+Ns(e).join(", ")+") were not.")})(s,n.label),r}})(e,t,{validate:p,label:"function"}))(Ds,["regex","attempt"]),Vs=(e,t,n,r)=>{const o=Fs(e,t,n);return zs(e,o.element,tn,C.some(o.offset),r,Rs,C.none())},Ws=(e,t,n,r)=>{const o=Fs(e,t,n);return zs(e,o.element,tn,C.some(o.offset),r,js,C.none())},Us=(e,t,n)=>{const r=O;if(!e.property().isText(t))return C.none();const o=e.property().getText(t);return n<=o.length?C.some(xt(t,n)):cn(e,t,e.property().isText,r).bind((t=>Us(e,t,n-o.length)))},Hs={previousChar:(e,t)=>{for(let n=t.getOr(e.length)-1;n>=0;n--)if("\ufeff"!==e.charAt(n))return C.some(Is(e,n));return C.none()},nextChar:(e,t)=>{for(let n=t.getOr(0)+1;n<e.length;n++)if("\ufeff"!==e.charAt(n))return C.some(Is(e,n));return C.none()},repeatLeft:Vs,repeatRight:Ws,expandLeft:(e,t,n,r)=>{const o=qs(r);return Vs(e,t,n,((e,t,n,r,s)=>{const l=s.getOr(r.length);return((e,t)=>{t.lastIndex=-1;const n=V(e).join("");return Ls(n.match(t)).map((e=>n.length-1-e))})(r.substring(0,l),o.regex()).fold((()=>t.kontinue()),(e=>o.attempt(t,n,r,e)))}))},expandRight:(e,t,n,r)=>{const o=qs(r);return Ws(e,t,n,((e,t,n,r,s)=>{const l=s.getOr(0);var a,i;return(a=r.substring(l),(i=o.regex()).lastIndex=-1,Ls(a.match(i))).fold((()=>t.kontinue()),(e=>o.attempt(t,n,r,l+e)))}))},scanRight:Us},Js=vt(),$s=(e,t)=>{const n=xt(e,t);return ge(e)?((e,t)=>Hs.scanRight(Js,e,t))(e,t).getOr(n):n},Ks=e=>ge(e)||"br"===se(e),Gs=(e,t,n,r)=>{return Ks(n.startContainer)&&Ks(n.endContainer)||(o=C.some(n),Cs(o).map((e=>({image:()=>e})))).isSome()?((e,t,n,r)=>{const o=t();if(e.hasFocus()){const t=(e=>{const t=$s(e.startContainer,e.startOffset),n=$s(e.endContainer,e.endOffset);return Os(t.element,t.offset,n.element,n.offset)})(((e,t)=>{const n=_s(e,t.startContainer,t.startOffset),r=_s(e,t.endContainer,t.endOffset);return Os(n.element,n.offset,r.element,r.offset)})(e.schema,n)),o=As(e);l=t,Ce((s=o).startContainer,l.startContainer)&&Ce(s.endContainer,l.endContainer)&&s.startOffset===l.startOffset&&s.endOffset===l.endOffset||((e,t,n)=>{const r=e.dom.createRng();r.setStart(t.startContainer.dom,t.startOffset),r.setEnd(t.endContainer.dom,t.endOffset),e.selection.setRng(r,n)})(e,t,r)}var s,l;return o})(e,t,n,r):((e,t)=>{if(e.hasFocus()){const n=e.selection.getBookmark(),r=t();return e.selection.moveToBookmark(n),r}return t()})(e,t);var o},Zs=(e,t)=>We(e,t).fold((()=>({element:e,offset:t})),(e=>{const t=Ve(e);return t.length>0?Zs(e,t.length-1):{element:e,offset:ge(e)?yt(e).length:0}})),Ys=e=>We(e.endContainer,e.endOffset-1).filter((t=>{return o=t,s=e.startContainer,n=o,r=k(Ce,s),((e,t)=>{const n=e=>{for(let r=0;r<e.childNodes.length;r++){const o=xe.fromDom(e.childNodes[r]);if(t(o))return C.some(o);const s=n(e.childNodes[r]);if(s.isSome())return s}return C.none()};return n(e.dom)})(n,r).isSome();var n,r,o,s})).fold((()=>ws(e.endContainer,e.endOffset)),(()=>Zs(e.endContainer,e.endOffset-1))),Xs=(e,t)=>{const n=As(e),r=e.selection.isForward(),o=(e=>{if((e=>{const t=((e,t)=>{const n=Ve(e);return n.length>0&&t<n.length?He(n[t],0):He(e,t)})(e.startContainer,e.startOffset).element;return ue(t)&&"false"===ye(t,"contenteditable")&&Ce(e.startContainer,e.endContainer)&&e.startOffset===e.endOffset-1})(e))return e;{const t=Ys(e),n=ws(e.startContainer,e.startOffset);return Os(n.element,n.offset,t.element,t.offset)}})(n);return Gs(e,t,o,r)},Qs=e=>{let t=[];return{bind:e=>{if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=M(t,(t=>t!==e))},trigger:(...n)=>{const r={};j(e,((e,t)=>{r[e]=n[t]})),j(t,(e=>{e(r)}))}}},el=e=>{const t=xe.fromDom((e=>{if($e()&&m(e.target)){const t=xe.fromDom(e.target);if(ue(t)&&m(t.dom.shadowRoot)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return H(t)}}return C.from(e.target)})(e).getOr(e.target)),n=()=>e.stopPropagation(),r=()=>e.preventDefault(),o=b(r,n);return((e,t,n,r,o,s,l)=>({target:e,x:t,y:n,stop:r,prevent:o,kill:s,raw:l}))(t,e.clientX,e.clientY,n,r,o,e)},tl=(e,t,n,r)=>{e.dom.removeEventListener(t,n,r)},nl=E,rl=(e,t,n)=>((e,t,n,r)=>((e,t,n,r,o)=>{const s=((e,t)=>n=>{e(n)&&t(el(n))})(n,r);return e.dom.addEventListener(t,s,o),{unbind:k(tl,e,t,s,o)}})(e,t,n,r,!1))(e,t,nl,n),ol=e=>{const t=(()=>{let e=!1;return{lock:()=>e?C.none():(e=!0,C.some(void 0)),unlock:()=>{if(!e)throw new Error("Double unlock");e=!1},runIfUnlocked:t=>{e||t()}}})(),n=(r={lookup:Qs(["element"]),scroll:Qs([]),change:Qs([])},{registry:G(r,(e=>({bind:e.bind,unbind:e.unbind}))),trigger:G(r,(e=>e.trigger))});var r;const o=((e,t)=>{let n=null;const r=()=>{c(n)||(clearTimeout(n),n=null)};return{cancel:r,throttle:(...t)=>{r(),n=setTimeout((()=>{n=null,e.apply(null,t)}),1e3)}}})((()=>{t.runIfUnlocked((()=>n.trigger.scroll()))})),s=((e,r)=>{let o=!1,s=!1;const l=()=>{o=!0,setTimeout((()=>{t.runIfUnlocked((()=>n.trigger.change()))}),0),setTimeout((()=>{o=!1,s&&(s=!1,l())}),1e3)};return()=>{o?s=!0:l()}})(),l=r=>{(e=>32===(e.which||e.keyCode))(r)&&(()=>{const r=Ss(e.selection.getRng());t.runIfUnlocked((()=>n.trigger.lookup(r.startContainer)))})()};return e.on("init",(()=>{let r=xe.fromDom(e.getBody());const a=xs(e)?e.getDoc():document,i=e.inline?"ResizeWindow":"ResizeEditor",c=xe.fromDom(a),u=rl(c,"scroll",o.throttle);o.throttle(),e.on(i,o.throttle),e.on("keyup",l),e.on("NodeChange",(e=>{if(e.selectionChange)return;const o=xe.fromDom(e.element);Ce(r,o)||(t.runIfUnlocked((()=>n.trigger.lookup(r))),r=o)})),e.on("SetContent",s),e.on("input",(e=>{const t=e.inputType;"insertFromPaste"!==t&&"insertFromDrop"!==t&&"insertReplacementText"!==t||s()})),e.on("remove",(()=>{o.cancel(),u.unbind()}))})),{events:n.registry,transact:e=>{t.lock().fold((()=>console.warn("TinyMCE spellchecker state error")),(()=>e.get((()=>{s(),t.unlock()}))))}}},sl=Yr(),ll=e=>((e,t)=>Jt(e)&&e.dom.classList.contains(t))(e,sl),al=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},il=(e,t,n)=>{const r=J(n);j(r,(r=>{const o=n[r];u(o)?o||e.add(t,r,C.none()):e.add(t,r,C.some(o))}))},cl=e=>e.fold(O,(e=>!e.ignore)),ul=(e,t,n)=>{const r={ignore:O,lang:w(n)},o=R(t,(e=>e.word)),s=M(o,((e,t)=>((e,t)=>{const n=D(e,t);return-1===n?C.none():C.some(n)})(o,e).filter((e=>e===t)).isSome()));$r(r,e,s,O)},gl=(e,t,n)=>M(e,(e=>!t.isWordIgnored(n,e))),dl=(e,t,n,r)=>{const o=t=>{const n=t.zone;il(e,n.lang,t.spelling);const r=J(t.spelling),o=((e,t,n)=>M(n,(n=>{const r=e.get(t,n);return cl(r)})))(e,n.lang,r);return{zone:n,words:M(n.words,(e=>{const t=hs(e.word);return I(o,t)}))}};return R(n,(e=>((e,t,n)=>{const r=R(e.words,(e=>hs(e.word)));return t(gl(r,n,e.lang),e.lang).map((t=>t.map((t=>({spelling:t,zone:e})))))})(e,t,r).map((e=>e.map(o)))))},ml=(e,t,n,r)=>{const o=t=>{il(e,t.lang,t.spelling)},s=((e,t)=>{if(0===e.length)return[];{let n=t(e[0]);const r=[];let o=[];for(let s=0,l=e.length;s<l;s++){const l=e[s],a=t(l);a!==n&&(r.push(o),o=[]),n=a,o.push(l)}return 0!==o.length&&r.push(o),r}})(((e,t)=>{const n=_.call(e,0);return n.sort(((e,t)=>e.detail.lang<t.detail.lang?-1:t.detail.lang<e.detail.lang?1:0)),n})(n),(e=>e.detail.lang)),l=R(s,(e=>{const n=R(e,(e=>e.detail.word));return((e,t,n,r)=>{const o=gl(e,r,t);return n.suggestions(o,t).map((e=>e.map((e=>({spelling:e,lang:t})))))})(n,e[0].detail.lang,t,r)}));return Ko(l).map((e=>(j(e,(e=>{e.each(o)})),Ne(e))))},pl=(e,t,n)=>{const r=(e,t,n)=>{e((()=>{j(t,(e=>{ul(e.zone,e.words,n)}))}))},o=(e,n,r,o)=>{if(0===e.length)return void n(!0,y);const s=al(!1),l=()=>{t.cancelCurrent(),s.set(!0)};let a=0;const i=new Map;j(e,((t,c)=>{t.get((t=>{if(i.set(c,t),n(!1,l),r)for(;i.has(a);)s.get()||o(i.get(a)),a+=1;else s.get()||o(t);s.get()||n(e.length===i.size,l)}))})),n(!1,l)};return{local:(t,n,o,s)=>{const l=(t=>R(t,(t=>{const n=((e,t,n)=>M(n,(n=>{const r=e.get(t,n.word);return cl(r)})))(e,t.lang,t.words);return{zone:t,words:n}})))(n.zones);r(t,l,o),s(!0,y)},remote:(s,l,a,i,c)=>{const u=l.zones,g=dl(e,t.suggestions,u,n);o(g,i,c,(e=>e.fold(y,(e=>r(s,[e],a)))))},check:(s,l,a,i,c)=>{const u=l.zones,g=dl(e,t.check,u,n);o(g,i,c,(e=>e.fold(y,(e=>r(s,[e],a)))))},fetch:r=>ml(e,t,r,n)}},hl=(e,t,n)=>{const r=al(t),o=(()=>{let e=[],t=!1;const n=()=>{t=!0,C.from(e.shift()).fold((()=>{t=!1}),(e=>{e.f(e.area,n)}))};return{enqueue:(r,o)=>{e.push(((e,t)=>({area:e,f:t}))(r,o)),t||n()},destroy:()=>{e=[]}}})(),s=(t,o,s,l,a,i)=>{const c=i?{assess:e=>Vn.inView(e)}:n(),u=((t,n,o)=>{switch(t.tag){case 0:return s=t.element,Ze(s)?((e,t,n,r)=>Gn(sr(e),t,n,r))(e,s,r.get(),c):lr();case 1:return((t,n,o,s)=>Ze(t)&&Ze(o)?((e,t,n,r,o,s,l)=>((e,t,n,r,o,s,l)=>{const a=Gt(e,t,n),i=Gt(e,r,o);return e.eq(a.element,i.element)?Gn(e,a.element,s,l):((e,t,n,r,o)=>{const s=Mn(e,t,n,O),l=$n(s.left,s.right);return Jn(e,s.left.item,s.right.item,r,l,o)})(e,a.element,i.element,s,l)})(sr(e),t,n,r,o,s,l))(e,t,n,o,s,r.get(),c):lr())(t.start,t.sOffset,t.finish,t.fOffset)}var s})(s);o(t,u,r.get(),l,a)};return{run:(e,t,n,r,o,l)=>{s(e,t,n,r,o,l)},setLang:r.set,schedule:(e,t,n,r,l)=>{o.enqueue(n,((n,o)=>{l()?o():s(e,t,n,((e,t)=>{l()?(t(),o()):e&&o()}),r,!1)}))},destroy:()=>{o.destroy()}}},fl=e=>{let t=C.none(),n=[];const r=e=>{o()?s(e):n.push(e)},o=()=>t.isSome(),s=e=>{t.each((t=>{e(t)}))};return e((e=>{var r;o()||(t=C.some(e),r=n,setTimeout((()=>j(r,s)),0),n=[])})),{get:r,getSync:()=>t.fold((()=>yo.error(mo(r))),yo.value),map:e=>fl((t=>{r((n=>{t(e(n))}))})),isReady:o}},yl={nu:fl,pure:e=>fl((t=>{t(e)}))},bl=(e,t,n)=>{const r=ls(t,(e=>{const t=(e=>{var t;return null!==(t=e.options.get("spellchecker_api_key"))&&void 0!==t?t:e.options.get("api_key")})(e);return d(t)?{}:{"tiny-api-key":t}})(e),void 0,n),o={},a=t=>{const n=(e=>{const t=M(e,l),n=R(t,(e=>{var t;return null===(t=e.error)||void 0===t?void 0:t.message})),r=M(n,s),o=oo(r);if(o.sort(),o.length>0){const e=(e=>L(e,(e=>0===e.status)))(t)?"Unable to communicate with the spelling service":"Error response from the spelling service";return e+" - "+o.join(", ")}return"An unexpected error occurred with the spelling service"})(t);return console.error(n),((e,t)=>{e.dispatch("SpellcheckError",t)})(e,{message:n}),t},i=(e,t)=>e?t().map((e=>e.mapError(a).toOptional())):po(C.none()),c=(e,t)=>Q(o,e).getOrThunk((()=>{const t=(e=>yl.nu((t=>{r.check(e,["startup"]).get((e=>{t(e.isValue()),e.mapError(a)}))})))(e);return o[e]=t,t})).getSync().fold((e=>e.bind((e=>i(e,t)))),(e=>i(e,t)));return{check:(e,t)=>c(t,(()=>r.check(t,e))),suggestions:(e,t)=>c(t,(()=>r.suggestions(t,e))),state:()=>r.dumpCache(),cancelCurrent:r.cancelCurrent}},wl=(e,t,n,r,o,s,l)=>{const a=(e=>{const t=()=>xs(e)?e.getWin():window,n=()=>{if(vs(e)){const t=(e.inline?e.getBody():e.getContentAreaContainer()).getBoundingClientRect();return e=>{const n=Ts(e);return{...n,top:ks(n.top,t),bottom:ks(n.bottom,t)}}}return Ts};return{sections:()=>(()=>{const r=e.getBody();if(!r)return[];const o=t(),s=n(),l=o.innerHeight,a=xe.fromDom(r),i=Ve(a);return z(i,(e=>{if(!ue(e))return!1;const t=s(e);return t.top<l&&t.bottom>0})).map((e=>{const t=z(i.slice(e+1),(e=>{if(!ue(e))return!1;const t=s(e);return!(t.top<l&&t.bottom>0)})).map((t=>e+1+t)).getOr(i.length);return i.slice(e,t)})).getOr([a])})(),viewport:()=>{const e=t(),r=e?e.innerHeight:0,o=n();return{assess:e=>{return ue(e)?(t=o(e),n=r,t.bottom<0?Vn.aboveView:t.top>n?Vn.belowView:Vn.inView)(e):Vn.inView(e);var t,n}}}}})(e),i=t=>Xs(e,t),c=(e=>{const t=e.gaol,n=e.editor,r=e.language,o=C.from(ds(n)).getOrThunk((()=>bl(n,e.url,e.serverSettings))),s=hl((e=>Ce(e,xe.fromDom(n.getBody()))),r,e.viewable.viewport),l=pl(e.cache,o,e.ignoreList),a=()=>n.removed||!Qr(t.spelling().get()),i=()=>{(e=>{const t=n.dom.select("span.mce-spellchecker-word");j(t,(e=>{(e=>{const t=e.parentNode,n=e.childNodes;if(t){for(;n.length>0;)t.insertBefore(n[0],e);t.removeChild(e)}})(e)}))})()};return e.editor.on("remove",(()=>{s.destroy()})),{run:(e,n)=>{const r=t.spelling().get();Qr(r)&&(s.setLang(r),s.run(e,l.local,n,y,!1,!1),s.schedule(e,l.remote,n,!1,a))},fetch:l.fetch,check:(e,n,r,o,a)=>{s.setLang(t.nonOffSpelling()),s.run(e,l.check,n,r,o,a)},refresh:()=>{const n=t.spelling().get();Qr(n)&&e.asYouType||i()},clear:i,state:o.state}})({editor:e,gaol:r,viewable:a,cache:n,url:t,language:r.spelling().get(),asYouType:o,serverSettings:s,ignoreList:l});e.on("init",(()=>{const t=e.getBody(),n=xe.fromDom(t);fe(n,"spellcheck",!1),c.refresh()})),e.on("remove",(()=>{const t=e.getBody(),r=xe.fromDom(t);we(r,"spellcheck"),n.destroy()}));const u=(e,t,n,r)=>{const o=ll(e)?ws(e,t):xt(e,t),s=ll(n)?ws(n,r):xt(n,r);return((e,t,n,r)=>{const o=((e,t,n,r)=>{const o=((e,t,n,r)=>{const o=Me(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o})(e,t,n,r),s=Ce(e,n)&&t===r;return o.collapsed&&!s})(n,r,e,t),s=o?xt(e,t):xt(n,r),l=o?xt(n,r):xt(e,t);return{tag:1,start:s.element,sOffset:s.offset,finish:l.element,fOffset:l.offset}})(o.element,o.offset,s.element,s.offset)},g=e=>{const t=e[0],n=e[e.length-1],r=Ue(n);return u(t,0,n,r)},d=()=>{const e=a.sections();if(e.length>0){const t=g(e);c.run(i,t)}},m=c.clear,p=c.fetch,h=o?C.some(ol(e)):C.none();h.each((e=>{e.events.lookup.bind((e=>{const t={tag:0,element:e.element};c.run(i,t)})),e.events.scroll.bind(d),e.events.change.bind(d)}));const f=h.fold((()=>e=>e.get(y)),(e=>e.transact));return{scanView:d,scanRange:(e,t,n,r)=>{const o=u(e,t,n,r);c.run(i,o)},checkDocument:(t,n)=>{const r=xe.fromDom(e.getBody()),o=Ve(r);if(o.length>0){const e=g(o);c.check(i,e,t,n,!0)}},fetch:p,clear:m,transact:f}},vl=(()=>{try{const e=te.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),C.some(e)}catch(e){return C.none()}})().fold((()=>{const e={};return{getItem:t=>e[t],setItem:(t,n)=>{e[t]=n}}}),(e=>({getItem:t=>e.getItem("mce."+t),setItem:(t,n)=>{e.setItem("mce."+t,n)}}))),xl=e=>{const t=((e,t)=>{const n=(e=>C.from(vl.getItem(e)))(e).map(JSON.parse);return n.getOr(t)})("spelling",e),n=Xn(t),r=al(n),o=al("no.language"===n?"en_us":n),s=r.set,l=r.get,a={setAndCache:(e,t)=>{((e,t)=>{e.options.set("spellchecker_language",t)})(e,t),s(t),((e,t)=>{const n=JSON.stringify(t);vl.setItem("spelling",n)})(0,t),Qr(t)&&o.set(t)},set:s,get:l};return{spelling:w(a),nonOffSpelling:o.get,setNonOffSpelling:o.set}},kl=(e,t,n)=>{e.undoManager.transact((()=>{const r=((e,t)=>((e,t)=>{const n=pr(e),r=mr(e);return C.from(e[0]).bind((o=>{var s;s=o,j(n,(e=>{nt(s,e)}));const l=C.from(r[0]);return l.each((e=>{bt(e,t)})),j(r.slice(1),(e=>{bt(e,"")})),j(e,gt),l}))})(Kr(e).fold(w([]),Sr),t))(t,n);r.each((t=>{const n=(e=>"img"===se(e)?1:(e=>ft.getOption(e))(e).fold((()=>Ve(e).length),(e=>e.length)))(t);e.selection.setCursorLocation(t.dom,n),e.focus()}))}))},Tl=(e,t)=>Kr(e).bind(Zr).map((e=>({detail:e,suggestions:t.suggestions(e.lang,e.word)}))),Sl=(e,t,n)=>{e.undoManager.transact((()=>{(e=>{const t=Kr(e).fold(w([]),Sr);j(t,(e=>{Kt(e,jr.wordLabel()),$t(e,jr.ignoreLabel())}))})(t)})),((e,t)=>{e.dispatch("SpellcheckerIgnore",{word:t})})(e,n)},Ol=(e,t,n,r,o)=>{o.ignore(r,n),(e=>{const t=Kr(e).fold(w([]),Or);j(t,dt)})(t),((e,t,n)=>{e.dispatch("SpellcheckerIgnoreAll",{word:t,language:n})})(e,n,r)},El=e=>{const t=Gr(e);return H(t).bind(Zr)},Cl=e=>Gr(e),_l=e=>Ne(R(e,Zr)),Al="SpellcheckStart SpellcheckEnd",Nl=()=>{const e=(e=>{const t=al(C.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(C.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{n(),t.set(C.some(e))}}})(y);return{...e,on:t=>e.get().each(t)}},Dl=[{text:"No suggestions found",value:"No suggestions found"}],Il=(e,t)=>{t.setEnabled("next",e.hasNext()),t.setEnabled("previous",e.hasPrevious())},Ll=(e,t,n,r)=>({title:"Spellcheck",body:{type:"panel",items:[{type:"label",label:"Misspelled word",items:[{type:"bar",items:[{type:"input",name:"textlabel",maximized:!0},{type:"bar",items:[{type:"button",name:"previous",text:"Previous",icon:"action-prev",borderless:!0,enabled:e.hasPrevious()},{type:"button",name:"next",text:"Next",icon:"action-next",borderless:!0,enabled:e.hasNext()}]}]}]},{type:"selectbox",name:"suggestions",label:"Suggestions",size:6,enabled:t.length>0,items:t.length>0?t:Dl}]},initialData:{textlabel:n,suggestions:r.length>0?r[0]:""},onClose:e.onClose,onChange:(e,t)=>{"textlabel"===t.name&&e.setEnabled("accept",e.getData().textlabel!==n)},onAction:(t,r)=>{switch(r.name){case"accept":e.replace(t,n);break;case"ignore":e.ignore(t);break;case"ignoreall":e.ignoreAll(t);break;case"next":e.next(t);break;case"previous":e.previous(t)}Il(e,t),t.focus("textlabel")},buttons:[{type:"custom",primary:!0,name:"accept",text:"Accept",enabled:t.length>0},{type:"custom",name:"ignore",text:"Ignore"},{type:"custom",name:"ignoreall",text:"Ignore all"}]}),Rl=(e,t,n)=>{const r=R(t,(e=>({text:e,value:e})));return Ll(e,r,n.word,t)},jl=(e,t,n,r,o)=>{const s={inline:"toolbar"},l=(()=>{const e={words:[],index:-1,current:C.none()},t=(t,r)=>{((e,t)=>z(e,(e=>e.id===t)))(t,r).fold(n,(n=>((t,n)=>{e.words=t,e.index=n,e.current=U(t,n)})(t,n)))},n=()=>{e.words=[],e.index=-1,e.current=C.none()};return{getNextWord:(t,n)=>{const r=e.words;if(r.length<=1)return C.none();{const o=e.index,s=r[o],l=V(r.slice(0,o)),a=r.slice(o+1),i=0===t?a.concat(l):l.concat(a);return n?P(i,(e=>e.word!==s.word||e.lang!==s.lang)):H(i)}},hasNext:()=>e.words.length>1&&e.index<e.words.length-1,hasPrevious:()=>e.words.length>1&&e.index>0,getCurrent:()=>e.current,setCurrent:t,refreshCurrent:n=>{e.current.each((e=>t(n,e.id)))},clear:n}})(),a=e=>Tl(e.element,t),i=()=>l.getCurrent().bind(a),c=al(!0),u=Nl(),g=Nl(),d={replace:(t,n)=>{const r=t.getData(),o=r.textlabel!==n?r.textlabel:r.suggestions;f(t,(t=>kl(e,t.detail.element,o)),0)},ignore:t=>{f(t,(t=>Sl(e,t.detail.element,t.detail.word)),0)},ignoreAll:n=>{f(n,(n=>Ol(e,n.detail.element,n.detail.word,n.detail.lang,t)),0,!0)},onClose:()=>{u.on(S),u.clear(),g.clear(),c.set(!0),((e,t,n)=>{t.clear(),n&&!e.removed&&t.scanView()})(e,n,r),l.clear()},next:e=>{f(e,y,0)},previous:e=>{f(e,y,1)},hasNext:l.hasNext,hasPrevious:l.hasPrevious},m=(e,t)=>{e.redial(t),e.focus("textlabel")},p=al(y),h=al(!1),f=(t,n,r,s=!1)=>{const a=((t,n)=>l.getCurrent().fold((()=>El(e)),(()=>l.getNextWord(t,n))).map((e=>e.id)))(r,s);i().each(n),(t=>{const n=Cl(e),r=_l(n);return t.bind((e=>(l.setCurrent(r,e),i())))})(a).fold((()=>{h.get()?(t.block("Finding word suggestions"),p.set((()=>{t.unblock(),f(t,n,0,s)}))):((()=>{const t=e.translate("No misspellings found.");e.notificationManager.open({text:t,type:"info",timeout:3e3})})(),t.close())}),(n=>{((t,n)=>{c.get()||(e.selection.scrollIntoView(t.detail.element.dom),t.suggestions.fold((()=>{((e,t)=>{t.block("Finding word suggestions"),e.get((e=>{t.unblock(),e.fold((()=>{console.log("TinyMCE spellchecker fetch error")}),(e=>{m(t,e)}))}))})(mo((e=>{o.getWordsSuggestionsAsync([t],(()=>e(C.none())),(t=>e(C.some(t))),0)})).map((e=>e.map((e=>Rl(d,e,t.detail))))),n)}),(e=>{const r=Rl(d,e,t.detail);m(n,r)})))})(n,t)}))},b=()=>mo((t=>{n.clear(),c.set(!1),h.set(!0);const r=Ll(d,[],"",[]),o=e.windowManager.open(r,s);g.set(o),f(o,y,0),t()})).bind((()=>mo((e=>setTimeout(e))))).bind((()=>mo((n=>{o.getWordsAsyncWithProgress(((r,s)=>{h.set(!r),u.set((()=>{r||s(),n()}));const a=Cl(e),i=_l(a);l.refreshCurrent(i),g.on((e=>Il(d,e)));const c=((e,t,n=100)=>{const r=e.length>n?n:e.length,o=e.slice(0,r),s=R(o,(e=>Tl(e,t)));return(e=>{const t={};return j(e,(e=>{t[(e=>e.detail.word+"("+e.detail.lang+")")(e)]=e})),X(t)})(Ne(s))})(a,t),m=M(c,(e=>e.suggestions.isNone()));m.length>0&&o.getWordsSuggestionsAsync(m,y,y,0);const f=El(e);(r||f.isSome())&&(p.get()(),p.set(y))}),!0)})))),w={open:()=>{g.isSet()||n.transact(b())},close:()=>g.on((e=>{l.clear(),e.close()}))};return w};tinymce.PluginManager.requireLangPack("tinymcespellchecker","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hi,hr,hu_HU,id,it,ja,kk,ko_KR,ms,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,vi,zh_CN,zh_TW"),tinymce.PluginManager.add("tinymcespellchecker",((e,t)=>{if(((e,t)=>!!e&&-1===((e,t)=>{const n=Te(e.major,t.major);if(0!==n)return n;const r=Te(e.minor,t.minor);if(0!==r)return r;const o=Te(e.patch,t.patch);return 0!==o?o:0})((e=>Oe((e=>[e.majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."))(e)))(e),Oe(t)))(tinymce,"6.0.0"))return console.error('The "tinymcespellchecker" plugin requires at least version 6.0.0 of TinyMCE.'),{};(e=>{var t;const n=e.options.register;n("spellchecker_dialog",{processor:"boolean",default:!1}),n("spellchecker_language",{processor:"string",default:null!==(t=e.getElement().getAttribute("lang"))&&void 0!==t?t:"en_us"}),n("spellchecker_languages",{processor:e=>s(e)?{value:e.split(","),valid:!0}:f(e,s)?{value:e,valid:!0}:{valid:!1,message:"Must be a string or string array."},default:["en_us","en_gb","da","nl","fi","fr","de","it","nb","pt","pt_pt","es","sv"]}),n("spellchecker_ignore_list",{processor:e=>l(e)||f(e,s),default:[]}),n("spellchecker_handler",{processor:"object"}),n("spellchecker_api_key",{processor:"string"}),n("spellchecker_rpc_url",{processor:"string",default:""}),n("spellchecker_active",{processor:"boolean",default:!0}),n("spellchecker_service_chunk_size",{processor:"number",default:ss.chunkSize}),n("spellchecker_service_max_retries",{processor:"number",default:ss.maxRetries}),n("spellchecker_service_max_in_flight",{processor:"number",default:ss.maxInFlight})})(e);const n=us(e),r=ms(e),o=((e={})=>{let t={};const n=e=>Q(t,e).getOr({}),r=(e,r)=>{const o=n(e);r(o),t[e]=o},o=(e,t)=>t(n(e)),s=(e,t,n)=>{r(e,(e=>{const r=hs(t);Q(e,r).forall((e=>e.suggestions.isNone()))&&(e[r]=fs(n,!1))}))},l=(e,t)=>{r(e,(e=>{const n=hs(t),r=Q(e,n).bind((e=>e.suggestions)),o=fs(r,!0);e[n]=o}))};return K(e,((e,t)=>{K(e,((e,n)=>{!0===e.ignore&&l(t,n),void 0!==e.suggestions&&s(t,n,C.some(e.suggestions))}))})),{add:s,get:(e,t)=>o(e,(e=>{const n=hs(t);return Q(e,n)})),ignore:l,ignoreAll:e=>{K(t,((t,n)=>{l(n,e)}))},suggestions:(e,t)=>o(e,(e=>{const n=hs(t);return Q(e,n).bind((e=>e.ignore?C.none():e.suggestions))})),state:()=>G(t,((e,t)=>G(e,(e=>({ignore:e.ignore,suggestions:e.suggestions.getOr([])}))))),destroy:()=>{t={}}}})(c),a=xl(n);var c;ps(e)||"no.language"===a.spelling().get()||a.spelling().set("no.language");const u=(e=>{const t=!cs(e),n=e.options.get("spellchecker_languages"),r=Y(((e,t=!0)=>B(e,((e,n)=>{const[r,o]=Ie(n,"=")?n.split("="):[null,n];return e[t?Xn(o):o]=C.from(r).getOrThunk((()=>Qn(o))),e}),{}))(n),((e,t)=>({text:e,value:t})));return t?as.concat(r):r})(e),g=!cs(e),d=(e=>({chunkSize:e.options.get("spellchecker_service_chunk_size"),maxRetries:e.options.get("spellchecker_service_max_retries"),maxInFlight:e.options.get("spellchecker_service_max_in_flight")}))(e),p=(e=>{const t=new Set,n={};return i(e)?j(e,(e=>t.add(e))):K(e,((e,t)=>{const r=Xn(t);n[r]=ys(e)})),{isWordIgnored:(e,r)=>!!t.has(r)||Q(n,e).fold(O,(e=>e.has(r))),addToLang:(e,t)=>{Q(n,e).fold((()=>n[e]=ys([t])),(e=>e.add(t)))},addToGlobal:e=>{t.add(e)}}})(gs(e)),h=wl(e,r,o,a,g,d,p),b=((e,t,n,r,o)=>{const s=t=>{const r=Qr(t);(r?n.scanView:n.clear)(),(r?to:no)(e)},l=(e,t)=>{n.checkDocument(e,t)},a=(e,t,o,s)=>{const l=()=>{s<3?a(e,t,o,s+1):t()};n.fetch(e).get((t=>{t.length>0?Tl(e[0].detail.element,r).bind((e=>e.suggestions)).fold(l,o):l()}))};return{changeLanguage:(n,r=!0)=>{const l=Xn(n),a=t.nonOffSpelling(),i=Qr(t.spelling().get());r||i?(t.spelling().setAndCache(e,l),o&&s(l)):t.setNonOffSpelling(l),Qr(n)&&n!==a&&(fe(xe.fromDom(e.getBody()),"lang",n),ro(e,n,a))},getLanguage:()=>{const e=t.spelling().get();return Qr(e)?e:t.nonOffSpelling()},toggleLanguage:()=>{const n=Qr(t.spelling().get())?eo():t.nonOffSpelling();t.spelling().setAndCache(e,n),s(n)},getWordsAsync:e=>{l((t=>{t&&e()}),!1)},getWordsAsyncWithProgress:l,getWordsSuggestionsAsync:a}})(e,a,h,o,g);((e,t)=>{const n=(t,n)=>({text:n,onAction:()=>{kl(e,t,n)}}),r={getSubstituteItemsOverMax:(e,t,r)=>{const o=t.slice(0,r),s=t.slice(r),l=R(o,(t=>n(e,t))),a=R(s,(t=>n(e,t))),i={type:"submenu",text:"More...",getSubmenuItems:w(a)};return l.concat([i])},getSubstituteItems:(e,t)=>R(t,(t=>n(e,t))),getSeparator:()=>({type:"separator"}),getIgnoreItem:(t,n)=>({text:"Ignore",onAction:()=>{Sl(e,t,n)}}),getIgnoreAllItem:(n,r,o)=>({text:"Ignore all",onAction:()=>{Ol(e,n,r,o,t)}}),getNoSuggestionsMenuItem:()=>({text:"No suggestions",enabled:!1,onAction:y})};e.ui.registry.addContextMenu("spellchecker",{update:e=>{const n=(e=>Tl(e,t).map((t=>((e,t,n,r,o)=>{const s=((e,t,n)=>0===e.length?[t.getNoSuggestionsMenuItem()]:e.length>4?t.getSubstituteItemsOverMax(n,e,4):t.getSubstituteItems(n,e))(r.getOr([]),o,e),l=[o.getSeparator(),o.getIgnoreItem(e,n),o.getIgnoreAllItem(e,n,t)];return s.concat(l)})(e,t.detail.lang,t.detail.word,t.suggestions,r))))(xe.fromDom(e));return n.getOr([])}})})(e,o),((e,t,n,r,o)=>{const s=R(t,(e=>({...e,type:"choiceitem"}))),l={tooltip:"Spellcheck...",icon:"spell-check",onAction:()=>{e.execCommand("mceSpellcheckDialog")}},a={tooltip:"Spellcheck...",icon:"spell-check",onAction:()=>{e.execCommand("mceSpellcheckDialog")},select:e=>e===n.spelling().get(),fetch:e=>{e(s)},onItemAction:(e,t)=>{r.changeLanguage(t)}},i={tooltip:"Spellcheck",icon:"spell-check",onAction:r.toggleLanguage,onSetup:t=>{const r=()=>{t.setActive(Qr(n.spelling().get()))};return r(),e.on(Al,r),()=>e.off(Al,r)},select:e=>e===n.spelling().get(),fetch:e=>{e(s)},onItemAction:(e,t)=>{r.changeLanguage(t)}},c={text:"Spellcheck...",icon:"spell-check",onAction:()=>{e.execCommand("mceSpellcheckDialog")}};o?(e.ui.registry.addSplitButton("spellchecker",i),e.ui.registry.addToggleMenuItem("spellchecker",{text:"Spellcheck",icon:"spell-check",onAction:r.toggleLanguage,onSetup:t=>{const r=()=>t.setActive(Qr(n.spelling().get()));return r(),e.on(Al,r),()=>e.off(Al,r)}}),e.ui.registry.addButton("spellcheckdialog",l),e.ui.registry.addMenuItem("spellcheckdialog",c)):(e.ui.registry.addSplitButton("spellchecker",a),e.ui.registry.addMenuItem("spellchecker",c));const u=e=>({type:"togglemenuitem",text:e.text,onAction:()=>r.changeLanguage(e.value),active:e.value===n.spelling().get()});e.ui.registry.addNestedMenuItem("spellcheckerlanguage",{text:"Spellcheck language",getSubmenuItems:()=>R(s,u)})})(e,u,a,b,g);const v=jl(e,o,h,g,b);return((e,t,n,r,o)=>{e.addCommand("mceSpellcheckEnable",(()=>{o?n.changeLanguage(r.nonOffSpelling()):t.open()})),e.addCommand("mceSpellcheckDisable",(()=>{o&&n.changeLanguage(eo()),t.close()})),e.addCommand("mceSpellcheckDialog",t.open),e.addCommand("mceSpellcheckDialogClose",t.close)})(e,v,b,a,g),e.on("init",(()=>{Qr(a.spelling().get())&&fe(xe.fromDom(e.getBody()),"lang",a.spelling().get()),ro(e,a.spelling().get(),"")})),((e,t,n,r)=>({addIgnoredWords:(r,o)=>{j(r,(r=>{if(m(o)){const e=Xn(o);t.addToLang(e,r),n.ignore(e,r)}else t.addToGlobal(r),n.ignoreAll(r);((e,t,n)=>{const r=Er(e,t,n);j(r,(e=>dt(e)))})(xe.fromDom(e.getDoc()),r,o)}))},getLanguage:r.getLanguage,setLanguage:e=>r.changeLanguage(e,!1)}))(e,p,o,b)}))}();