/*!
 * Tiny Advanced Tables plugin
 *
 * Copyright (c) 2022 Ephox Corporation DBA Tiny Technologies, Inc.
 * Licensed under the Tiny commercial license. See https://www.tiny.cloud/legal/
 *
 * Version: 2.0.2-67
 */

!function(){"use strict";const e=e=>parseInt(e,10),t=(e,t)=>{const o=e-t;return 0===o?0:o>0?1:-1},o=(e,t,o)=>({major:e,minor:t,patch:o}),n=t=>{const n=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(t);return n?o(e(n[1]),e(n[2]),e(n[3])):o(0,0,0)},r=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(o=n=e,(r=String).prototype.isPrototypeOf(o)||(null===(s=n.constructor)||void 0===s?void 0:s.name)===r.name)?"string":t;var o,n,r,s})(t)===e,s=e=>t=>typeof t===e,l=e=>t=>e===t,c=r("string"),a=r("object"),i=r("array"),m=l(null),u=s("boolean"),d=l(void 0),h=e=>null==e,p=e=>!h(e),g=s("function"),f=s("number");class w{constructor(e,t){this.tag=e,this.value=t}static some(e){return new w(!0,e)}static none(){return w.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?w.some(e(this.value)):w.none()}bind(e){return this.tag?e(this.value):w.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:w.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return p(e)?w.some(e):w.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}w.singletonNone=new w(!1);const b=()=>{},v=e=>()=>e,y=e=>e,C=(e,t)=>e===t;function x(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const S=v(!1),T=v(!0),R=Array.prototype.slice,D=Array.prototype.indexOf,O=Array.prototype.push,A=(e,t)=>{return o=e,n=t,D.call(o,n)>-1;var o,n},k=(e,t)=>{for(let o=0,n=e.length;o<n;o++)if(t(e[o],o))return!0;return!1},E=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},N=(e,t)=>{const o=e.length,n=new Array(o);for(let r=0;r<o;r++){const o=e[r];n[r]=t(o,r)}return n},W=(e,t)=>{for(let o=0,n=e.length;o<n;o++)t(e[o],o)},L=(e,t)=>{const o=[],n=[];for(let r=0,s=e.length;r<s;r++){const s=e[r];(t(s,r)?o:n).push(s)}return{pass:o,fail:n}},M=(e,t)=>{const o=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t(r,n)&&o.push(r)}return o},j=(e,t)=>{if(0===e.length)return[];{let o=t(e[0]);const n=[];let r=[];for(let s=0,l=e.length;s<l;s++){const l=e[s],c=t(l);c!==o&&(n.push(r),r=[]),o=c,r.push(l)}return 0!==r.length&&n.push(r),n}},B=(e,t,o)=>(((e,t)=>{for(let o=e.length-1;o>=0;o--)t(e[o],o)})(e,((e,n)=>{o=t(o,e,n)})),o),I=(e,t,o)=>(W(e,((e,n)=>{o=t(o,e,n)})),o),z=(e,t)=>((e,t,o)=>{for(let n=0,r=e.length;n<r;n++){const r=e[n];if(t(r,n))return w.some(r);if(o(r,n))break}return w.none()})(e,t,S),_=(e,t)=>(e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!i(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);O.apply(t,e[o])}return t})(N(e,t)),P=(e,t)=>{for(let o=0,n=e.length;o<n;++o)if(!0!==t(e[o],o))return!1;return!0},F=(e,t)=>{const o=R.call(e,0);return o.sort(t),o},V=(e,t)=>t>=0&&t<e.length?w.some(e[t]):w.none(),$=e=>V(e,0),G=e=>V(e,e.length-1),q=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return w.none()},H=(e,t,o=C)=>e.exists((e=>o(e,t))),U=(e,t,o)=>e.isSome()&&t.isSome()?w.some(o(e.getOrDie(),t.getOrDie())):w.none(),K=e=>e.bind(y),Q=(e,t)=>e?w.some(t):w.none(),X=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Y={fromHtml:(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return X(o.childNodes[0])},fromTag:(e,t)=>{const o=(t||document).createElement(e);return X(o)},fromText:(e,t)=>{const o=(t||document).createTextNode(e);return X(o)},fromDom:X,fromPoint:(e,t,o)=>w.from(e.dom.elementFromPoint(t,o)).map(X)};"undefined"!=typeof window?window:Function("return this;")();const J=e=>e.dom.nodeName.toLowerCase(),Z=e=>e.dom.nodeType,ee=e=>t=>Z(t)===e,te=e=>8===Z(e)||"#comment"===J(e),oe=ee(1),ne=ee(3),re=ee(9),se=ee(11),le=e=>t=>oe(t)&&J(t)===e,ce=(e,t)=>{const o=e.dom;if(1!==o.nodeType)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},ae=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,ie=(e,t)=>e.dom===t.dom,me=ce,ue=e=>Y.fromDom(e.dom.ownerDocument),de=e=>re(e)?e:ue(e),he=e=>w.from(e.dom.parentNode).map(Y.fromDom),pe=(e,t)=>{const o=g(t)?t:S;let n=e.dom;const r=[];for(;null!==n.parentNode&&void 0!==n.parentNode;){const e=n.parentNode,t=Y.fromDom(e);if(r.push(t),!0===o(t))break;n=e}return r},ge=e=>w.from(e.dom.previousSibling).map(Y.fromDom),fe=e=>w.from(e.dom.nextSibling).map(Y.fromDom),we=e=>N(e.dom.childNodes,Y.fromDom),be=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode)?e=>Y.fromDom(e.dom.getRootNode()):de,ve=e=>Y.fromDom(e.dom.host),ye=e=>{const t=ne(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return(e=>{const t=be(e);return se(o=t)&&p(o.dom.host)?w.some(t):w.none();var o})(Y.fromDom(t)).fold((()=>o.body.contains(t)),(n=ye,r=ve,e=>n(r(e))));var n,r},Ce=(e,t)=>{let o=[];return W(we(e),(e=>{t(e)&&(o=o.concat([e])),o=o.concat(Ce(e,t))})),o},xe=(e,t,o)=>((e,o,n)=>M(pe(e,n),(e=>ce(e,t))))(e,0,o),Se=(e,t)=>((e,o)=>M(we(e),(e=>ce(e,t))))(e),Te=(e,t)=>((e,t)=>{const o=void 0===t?document:t.dom;return ae(o)?[]:N(o.querySelectorAll(e),Y.fromDom)})(t,e),Re=(e,t,o)=>{let n=e.dom;const r=g(o)?o:S;for(;n.parentNode;){n=n.parentNode;const e=Y.fromDom(n);if(t(e))return w.some(e);if(r(e))break}return w.none()},De=(e,t,o)=>Re(e,(e=>ce(e,t)),o),Oe=(e,t)=>((e,o)=>z(e.dom.childNodes,(e=>{return o=Y.fromDom(e),ce(o,t);var o})).map(Y.fromDom))(e),Ae=(e,t)=>((e,t)=>{const o=void 0===t?document:t.dom;return ae(o)?w.none():w.from(o.querySelector(e)).map(Y.fromDom)})(t,e),ke=(e,t,o)=>((e,t,o,n,r)=>((e,t)=>ce(e,t))(o,n)?w.some(o):g(r)&&r(o)?w.none():t(o,n,r))(0,De,e,t,o),Ee=Object.keys,Ne=Object.hasOwnProperty,We=(e,t)=>{const o=Ee(e);for(let n=0,r=o.length;n<r;n++){const r=o[n];t(e[r],r)}},Le=(e,t)=>{const o=[];return We(e,((e,n)=>{o.push(t(e,n))})),o},Me=e=>Le(e,y),je=e=>Ee(e).length,Be=(e,t)=>Ie(e,t)?w.from(e[t]):w.none(),Ie=(e,t)=>Ne.call(e,t),ze=e=>{for(const t in e)if(Ne.call(e,t))return!1;return!0},_e=(e,t,o)=>{if(!(c(o)||u(o)||f(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},Pe=(e,t,o)=>{_e(e.dom,t,o)},Fe=(e,t)=>{const o=e.dom;We(t,((e,t)=>{_e(o,t,e)}))},Ve=(e,t)=>{const o=e.dom.getAttribute(t);return null===o?void 0:o},$e=(e,t)=>w.from(Ve(e,t)),Ge=(e,t)=>{e.dom.removeAttribute(t)},qe=e=>I(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),He=(e,t,o=0,n)=>{const r=e.indexOf(t,o);return-1!==r&&(!!d(n)||r+t.length<=n)},Ue=(e=>t=>t.replace(e,""))(/^\s+|\s+$/g),Ke=e=>!(e=>e.length>0)(e),Qe=e=>void 0!==e.style&&g(e.style.getPropertyValue),Xe=(e,t,o)=>{((e,t,o)=>{if(!c(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);Qe(e)&&e.style.setProperty(t,o)})(e.dom,t,o)},Ye=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return""!==n||ye(e)?n:Je(o,t)},Je=(e,t)=>Qe(e)?e.style.getPropertyValue(t):"",Ze=(e,t)=>{const o=e.dom,n=Je(o,t);return w.from(n).filter((e=>e.length>0))},et=(e,t)=>{((e,t)=>{Qe(e)&&e.style.removeProperty(t)})(e.dom,t),H($e(e,"style").map(Ue),"")&&Ge(e,"style")},tt=(e,t,o=0)=>$e(e,t).map((e=>parseInt(e,10))).getOr(o),ot=e=>le("col")(e)?tt(e,"span",1)>1:((e,t)=>tt(e,"colspan",1))(e)>1,nt=v(10),rt=(e,t)=>st(e,t,T),st=(e,t,o)=>_(we(e),(e=>ce(e,t)?o(e)?[e]:[]:st(e,t,o))),lt=["tfoot","thead","tbody","colgroup"],ct=(e,t,o)=>({element:e,rowspan:t,colspan:o}),at=(e,t,o)=>({element:e,cells:t,section:o}),it=(e,t,o)=>({element:e,isNew:t,isLocked:o}),mt=(e,t,o,n)=>({element:e,cells:t,section:o,isNew:n}),ut=(e,t)=>((e,t,o=S)=>o(t)?w.none():A(e,J(t))?w.some(t):De(t,e.join(","),(e=>ce(e,"table")||o(e))))(["td","th"],e,t),dt=e=>rt(e,"th,td"),ht=e=>ce(e,"colgroup")?Se(e,"col"):_(ft(e),(e=>Se(e,"col"))),pt=(e,t)=>ke(e,"table",t),gt=e=>rt(e,"tr"),ft=e=>pt(e).fold(v([]),(e=>Se(e,"colgroup"))),wt=e=>he(e).map((e=>{const t=J(e);return(e=>A(lt,e))(t)?t:"tbody"})).getOr("tbody"),bt=(e,t)=>mt(e.element,t,e.section,e.isNew),vt=(e,t)=>e.cells[t],yt=(e,t)=>vt(e,t).element,Ct=e=>{const t=L(e,(e=>"colgroup"===e.section));return{rows:t.fail,cols:t.pass}},xt="data-snooker-locked-cols",St=e=>$e(e,xt).bind((e=>w.from(e.match(/\d+/g)))).map((e=>((e,t)=>{const o={};for(let n=0,r=e.length;n<r;n++){const r=e[n];o[String(r)]=t(r,n)}return o})(e,T))),Tt=(e,t)=>e+","+t,Rt=e=>{const t={},o=[],n=$(e).map((e=>e.element)).bind(pt).bind(St).getOr({});let r=0,s=0,l=0;const{pass:c,fail:a}=L(e,(e=>"colgroup"===e.section));W(a,(e=>{const c=[];W(e.cells,(e=>{let o=0;for(;void 0!==t[Tt(l,o)];)o++;const r=((e,t)=>Ie(e,t)&&void 0!==e[t]&&null!==e[t])(n,o.toString()),a=((e,t,o,n,r,s)=>({element:e,rowspan:t,colspan:o,row:n,column:r,isLocked:s}))(e.element,e.rowspan,e.colspan,l,o,r);for(let n=0;n<e.colspan;n++)for(let r=0;r<e.rowspan;r++){const e=o+n,c=Tt(l+r,e);t[c]=a,s=Math.max(s,e+1)}c.push(a)})),r++,o.push(at(e.element,c,e.section)),l++}));const{columns:i,colgroups:m}=G(c).map((e=>{const t=(e=>{const t={};let o=0;return W(e.cells,(e=>{const n=e.colspan;E(n,(r=>{const s=o+r;t[s]=((e,t,o)=>({element:e,colspan:t,column:o}))(e.element,n,s)})),o+=n})),t})(e),o=((e,t)=>({element:e,columns:t}))(e.element,Me(t));return{colgroups:[o],columns:t}})).getOrThunk((()=>({colgroups:[],columns:{}}))),u=((e,t)=>({rows:e,columns:t}))(r,s);return{grid:u,access:t,all:o,columns:i,colgroups:m}},Dt=e=>{const t=(e=>{const t=gt(e);return o=[...ft(e),...t],n=wt,N(o,(e=>{if("colgroup"===J(e)){const t=N(ht(e),(e=>{const t=tt(e,"span",1);return ct(e,1,t)}));return at(e,t,"colgroup")}{const t=N(dt(e),(e=>{const t=tt(e,"rowspan",1),o=tt(e,"colspan",1);return ct(e,t,o)}));return at(e,t,n(e))}}));var o,n})(e);return Rt(t)},Ot=Rt,At=(e,t,o)=>w.from(e.access[Tt(t,o)]),kt=(e,t,o)=>{const n=((e,t)=>{const o=_(e.all,(e=>e.cells));return M(o,t)})(e,(e=>o(t,e.element)));return n.length>0?w.some(n[0]):w.none()},Et=e=>Me(e.columns),Nt=e=>Ee(e.columns).length>0,Wt=(e,t)=>w.from(e.columns[t]),Lt=e=>Y.fromDom(e.getBody()),Mt=e=>t=>ie(t,Lt(e)),jt=e=>Y.fromDom(e.selection.getStart()),Bt=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,It=(e,t,o)=>((e,t,o)=>{const n=kt(e,t,ie),r=kt(e,o,ie);return n.bind((e=>r.map((t=>{return o=e,n=t,{startRow:Math.min(o.row,n.row),startCol:Math.min(o.column,n.column),finishRow:Math.max(o.row+o.rowspan-1,n.row+n.rowspan-1),finishCol:Math.max(o.column+o.colspan-1,n.column+n.colspan-1)};var o,n}))))})(e,t,o).bind((t=>((e,t)=>{let o=!0;const n=x(Bt,t);for(let r=t.startRow;r<=t.finishRow;r++)for(let s=t.startCol;s<=t.finishCol;s++)o=o&&At(e,r,s).exists(n);return o?w.some(t):w.none()})(e,t))),zt=(e,t,o)=>{const n=_t(e);return It(n,t,o)},_t=Dt,Pt=(e,t)=>{he(e).each((o=>{o.dom.insertBefore(t.dom,e.dom)}))},Ft=(e,t)=>{fe(e).fold((()=>{he(e).each((e=>{$t(e,t)}))}),(e=>{Pt(e,t)}))},Vt=(e,t)=>{(e=>((e,t)=>{const o=e.dom.childNodes;return w.from(o[0]).map(Y.fromDom)})(e))(e).fold((()=>{$t(e,t)}),(o=>{e.dom.insertBefore(t.dom,o.dom)}))},$t=(e,t)=>{e.dom.appendChild(t.dom)},Gt=(e,t)=>{Pt(e,t),$t(t,e)},qt=(e,t)=>{W(t,((o,n)=>{const r=0===n?e:t[n-1];Ft(r,o)}))},Ht=(e,t)=>{W(t,(t=>{$t(e,t)}))},Ut=e=>{e.dom.textContent="",W(we(e),(e=>{Kt(e)}))},Kt=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Qt=e=>{const t=we(e);t.length>0&&qt(e,t),Kt(e)},Xt=((e,t)=>{const o=t=>e(t)?w.from(t.dom.nodeValue):w.none();return{get:t=>{if(!e(t))throw new Error("Can only get text value of a text node");return o(t).getOr("")},getOption:o,set:(t,o)=>{if(!e(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=o}}})(ne),Yt=e=>Xt.get(e),Jt=(e,t)=>Xt.set(e,t);var Zt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],eo=()=>({up:v({selector:De,closest:ke,predicate:Re,all:pe}),down:v({selector:Te,predicate:Ce}),styles:v({get:Ye,getRaw:Ze,set:Xe,remove:et}),attrs:v({get:Ve,set:Pe,remove:Ge,copyTo:(e,t)=>{const o=qe(e);Fe(t,o)}}),insert:v({before:Pt,after:Ft,afterAll:qt,append:$t,appendAll:Ht,prepend:Vt,wrap:Gt}),remove:v({unwrap:Qt,remove:Kt}),create:v({nu:Y.fromTag,clone:e=>Y.fromDom(e.dom.cloneNode(!1)),text:Y.fromText}),query:v({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:ge,nextSibling:fe}),property:v({children:we,name:J,parent:he,document:e=>de(e).dom,isText:ne,isComment:te,isElement:oe,isSpecial:e=>{const t=J(e);return A(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>oe(e)?$e(e,"lang"):w.none(),getText:Yt,setText:Jt,isBoundary:e=>!!oe(e)&&("body"===J(e)||A(Zt,J(e))),isEmptyTag:e=>!!oe(e)&&A(["br","img","hr","input"],J(e)),isNonEditable:e=>oe(e)&&"false"===Ve(e,"contenteditable")}),eq:ie,is:me});const to=(e,t,o,n)=>{const r=t(e,o);return B(n,((o,n)=>{const r=t(e,n);return oo(e,o,r)}),r)},oo=(e,t,o)=>t.bind((t=>o.filter(x(e.eq,t)))),no=eo(),ro=e=>De(e,"table"),so=(e,t,o)=>Ae(e,t).bind((t=>Ae(e,o).bind((e=>{return(o=ro,n=[t,e],((e,t,o)=>o.length>0?((e,t,o,n)=>n(e,t,o[0],o.slice(1)))(e,t,o,to):w.none())(no,((e,t)=>o(t)),n)).map((o=>({first:t,last:e,table:o})));var o,n})))),lo=y,co=e=>{const t=(e,t)=>$e(e,t).exists((e=>parseInt(e,10)>1));return e.length>0&&P(e,(e=>t(e,"rowspan")||t(e,"colspan")))?w.some(e):w.none()},ao=(e,t,o)=>{return t.length<=1?w.none():(n=e,r=o.firstSelectedSelector,s=o.lastSelectedSelector,so(n,r,s).bind((e=>{const t=e=>ie(n,e),o="thead,tfoot,tbody,table",r=De(e.first,o,t),s=De(e.last,o,t);return r.bind((t=>s.bind((o=>ie(t,o)?zt(e.table,e.first,e.last):w.none()))))}))).map((e=>({bounds:e,cells:t})));var n,r,s},io={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},mo=e=>({element:e,mergable:w.none(),unmergable:w.none(),selection:[e]}),uo=(e,t,o)=>({element:o,mergable:ao(t,e,io),unmergable:co(e),selection:lo(e)}),ho=e=>(t,o)=>{const n=J(t),r="col"===n||"colgroup"===n?pt(s=t).bind((e=>((e,t)=>((e,t)=>{const o=Te(e,t);return o.length>0?w.some(o):w.none()})(e,t))(e,io.firstSelectedSelector))).fold(v(s),(e=>e[0])):t;var s;return ke(r,e,o)},po=ho("th,td,caption"),go=ho("th,td"),fo=e=>{return t=e.model.table.getSelectedCells(),N(t,Y.fromDom);var t},wo=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},bo=(e,t)=>({element:e,offset:t}),vo=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind((t=>vo(e,t,o).orThunk((()=>w.some(t))))):w.none(),yo=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,Co=(e,t)=>{const o=vo(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return bo(o,yo(e,o));const n=e.property().children(o);return n.length>0?Co(e,n[n.length-1]):bo(o,yo(e,o))},xo=Co,So=eo(),To={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Ro=(()=>{const e="[0-9]+",t="[eE][+-]?[0-9]+",o=e=>`(?:${e})?`,n=["Infinity","[0-9]+\\."+o(e)+o(t),"\\.[0-9]+"+o(t),e+o(t)].join("|");return new RegExp(`^([+-]?(?:${n}))(.*)$`)})(),Do=(e,t)=>w.from(Ro.exec(e)).bind((e=>{const o=Number(e[1]),n=e[2];return((e,t)=>k(t,(t=>k(To[t],(t=>e===t)))))(n,t)?w.some({value:o,unit:n}):w.none()})),Oo=(e,t,o)=>((e,t)=>(e=>{const t=parseFloat(e);return isNaN(t)?w.none():w.some(t)})(e).getOr(t))(Ye(e,t),o),Ao=((e,t)=>{const o=t=>{const o=(e=>e.dom.offsetWidth)(t);if(o<=0||null===o){const o=Ye(t,e);return parseFloat(o)||0}return o},n=(e,t)=>I(t,((t,o)=>{const n=Ye(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r}),0);return{set:(e,t)=>{if(!f(t)&&!t.match(/^[0-9]+$/))throw new Error("width.set accepts only positive integer values. Value was "+t);const o=e.dom;Qe(o)&&(o.style.width=t+"px")},get:o,getOuter:o,aggregate:n,max:(e,t,o)=>{const r=n(e,o);return t>r?t-r:0}}})("width"),ko=e=>Ao.get(e),Eo=e=>Ao.getOuter(e),No=e=>((e,t)=>{const o=e.dom,n=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?n:((e,t,o,n)=>t-Oo(e,"padding-left",0)-Oo(e,"padding-right",0)-Oo(e,"border-left-width",0)-Oo(e,"border-right-width",0))(e,n)})(e,"content-box"),Wo=le("col"),Lo=(e,t,o)=>{const n=(r=e,w.from(r.dom.parentElement).map(Y.fromDom)).getOrThunk((()=>(e=>{const t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return Y.fromDom(t)})(ue(e))));var r;return t(e)/o(n)*100},Mo=(e,t)=>{Xe(e,"width",t+"px")},jo=(e,t)=>{Xe(e,"width",t+"%")},Bo=e=>((e,t)=>Ze(e,t).orThunk((()=>$e(e,t).map((e=>e+"px")))))(e,"width"),Io=e=>Lo(e,ko,No),zo=e=>{return Wo(e)?ko(e):Oo(t=e,"width",t.dom.offsetWidth);var t},_o=(e,t,o)=>{Xe(e,"width",t+o)},Po=v(/(\d+(\.\d+)?)%/),Fo=(e,t)=>{if(!ot(e)){const o=(e=>Bo(e).bind((e=>Do(e,["fixed","relative","empty"]))))(e);o.each((o=>{const n=o.value/2;_o(e,n,o.unit),_o(t,n,o.unit)}))}},Vo=le("col"),$o=le("colgroup"),Go=e=>({element:e,colspan:tt(e,"colspan",1),rowspan:tt(e,"rowspan",1)}),qo=(e,t=Go)=>{const o=o=>{if((e=>"tr"===J(e)||$o(e))(o))return $o((r={element:o}).element)?e.colgroup(r):e.row(r);{const r=o,s=(t=>Vo(t.element)?e.col(t):e.cell(t))(t(r));return n=w.some({item:r,replacement:s}),s}var r};let n=w.none();return{getOrInit:(e,t)=>n.fold((()=>o(e)),(n=>t(e,n.item)?n.replacement:o(e)))}},Ho=e=>N(e,v(0)),Uo=e=>(t,o,n,r)=>{if(e(n)){const e=Math.max(r,t[o]-Math.abs(n)),s=Math.abs(e-t[o]);return n>=0?s:-s}return n},Ko=Uo((e=>e<0)),Qo=Uo(T),Xo=()=>{const e=(e,t,o,n,r)=>{const s=Qo(e,n>=0?o:t,n,r);return((e,t,o,n,r)=>r(e.slice(0,t)).concat(n).concat(r(e.slice(o))))(e,t,o+1,[s,-s],Ho)};return{resizeTable:(e,t,o)=>{o&&e(t)},clampTableDelta:(e,t,o,n,r)=>{if(r){if(o>=0)return o;{const t=I(e,((e,t)=>e+t-n),0);return Math.max(-t,o)}}return Ko(e,t,o,n)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,o,n,r,s,l)=>e(t,n,r,s,l),calcRightEdgeDeltas:(e,t,o,n,r,s)=>{if(s)return Ho(e);{const t=n/e.length;return N(e,v(t))}},calcRedestributedWidths:(e,t,o,n)=>({delta:0,newSizes:e})}},Yo=(e,t)=>Y.fromDom(e.dom.cloneNode(t)),Jo=(e,t)=>{const o=((e,t)=>{const o=Y.fromTag(t),n=qe(e);return Fe(o,n),o})(e,t),n=we((e=>Yo(e,!0))(e));return Ht(o,n),o},Zo=(le("th"),(e,t,o)=>it(o(e.element,t),!0,e.isLocked)),en=()=>({transformRow:y,transformCell:Zo}),tn=()=>on(0,0),on=(e,t)=>({major:e,minor:t}),nn={nu:on,detect:(e,t)=>{const o=String(t).toLowerCase();return 0===e.length?tn():((e,t)=>{const o=((e,t)=>{for(let o=0;o<e.length;o++){const n=e[o];if(n.test(t))return n}})(e,t);if(!o)return{major:0,minor:0};const n=e=>Number(t.replace(o,"$"+e));return on(n(1),n(2))})(e,o)},unknown:tn},rn=(e,t)=>{const o=String(t).toLowerCase();return z(e,(e=>e.search(o)))},sn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ln=e=>t=>He(t,e),cn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>He(e,"edge/")&&He(e,"chrome")&&He(e,"safari")&&He(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,sn],search:e=>He(e,"chrome")&&!He(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>He(e,"msie")||He(e,"trident")},{name:"Opera",versionRegexes:[sn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ln("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ln("firefox")},{name:"Safari",versionRegexes:[sn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(He(e,"safari")||He(e,"mobile/"))&&He(e,"applewebkit")}],an=[{name:"Windows",search:ln("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>He(e,"iphone")||He(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ln("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:ln("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ln("linux"),versionRegexes:[]},{name:"Solaris",search:ln("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ln("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ln("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],mn={browsers:v(cn),oses:v(an)},un="Edge",dn="Chromium",hn="Opera",pn="Firefox",gn="Safari",fn=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(un),isChromium:n(dn),isIE:n("IE"),isOpera:n(hn),isFirefox:n(pn),isSafari:n(gn)}},wn=()=>fn({current:void 0,version:nn.unknown()}),bn=fn,vn=(v(un),v(dn),v("IE"),v(hn),v(pn),v(gn),"Windows"),yn="Android",Cn="Linux",xn="macOS",Sn="Solaris",Tn="FreeBSD",Rn="ChromeOS",Dn=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(vn),isiOS:n("iOS"),isAndroid:n(yn),isMacOS:n(xn),isLinux:n(Cn),isSolaris:n(Sn),isFreeBSD:n(Tn),isChromeOS:n(Rn)}},On=()=>Dn({current:void 0,version:nn.unknown()}),An=Dn,kn=(v(vn),v("iOS"),v(yn),v(Cn),v(xn),v(Sn),v(Tn),v(Rn),e=>window.matchMedia(e).matches);let En=wo((()=>((e,t,o)=>{const n=mn.browsers(),r=mn.oses(),s=t.bind((e=>((e,t)=>q(t.brands,(t=>{const o=t.brand.toLowerCase();return z(e,(e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:nn.nu(parseInt(t.version,10),0)})))})))(n,e))).orThunk((()=>((e,t)=>rn(e,t).map((e=>{const o=nn.detect(e.versionRegexes,t);return{current:e.name,version:o}})))(n,e))).fold(wn,bn),l=((e,t)=>rn(e,t).map((e=>{const o=nn.detect(e.versionRegexes,t);return{current:e.name,version:o}})))(r,e).fold(On,An),c=((e,t,o,n)=>{const r=e.isiOS()&&!0===/ipad/i.test(o),s=e.isiOS()&&!r,l=e.isiOS()||e.isAndroid(),c=l||n("(pointer:coarse)"),a=r||!s&&l&&n("(min-device-width:768px)"),i=s||l&&!a,m=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),u=!i&&!a&&!m;return{isiPad:v(r),isiPhone:v(s),isTablet:v(a),isPhone:v(i),isTouch:v(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:v(m),isDesktop:v(u)}})(l,s,e,o);return{browser:s,os:l,deviceType:c}})(navigator.userAgent,w.from(navigator.userAgentData),kn)));const Nn=(e,t=T)=>{const o=e.grid,n=E(o.columns,y),r=E(o.rows,y);return N(n,(o=>Wn((()=>_(r,(t=>At(e,t,o).filter((e=>e.column===o)).toArray()))),(e=>1===e.colspan&&t(e.element)),(()=>At(e,0,o)))))},Wn=(e,t,o)=>{const n=e();return z(n,t).orThunk((()=>w.from(n[0]).orThunk(o))).map((e=>e.element))},Ln=(e,t)=>({left:e,top:t,translate:(o,n)=>Ln(e+o,t+n)}),Mn=Ln,jn=(e,t)=>void 0!==e?e:void 0!==t?t:0,Bn=e=>{const t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return Mn(o.offsetLeft,o.offsetTop);const s=jn(null==n?void 0:n.pageYOffset,r.scrollTop),l=jn(null==n?void 0:n.pageXOffset,r.scrollLeft),c=jn(r.clientTop,o.clientTop),a=jn(r.clientLeft,o.clientLeft);return In(e).translate(l-a,s-c)},In=e=>{const t=e.dom,o=t.ownerDocument.body;return o===t?Mn(o.offsetLeft,o.offsetTop):ye(e)?(e=>{const t=e.getBoundingClientRect();return Mn(t.left,t.top)})(t):Mn(0,0)},zn=(e,t)=>({col:e,x:t}),_n=e=>Bn(e).left+Eo(e),Pn=e=>Bn(e).left,Fn=(e,t)=>zn(e,Pn(t)),Vn=(e,t)=>zn(e,_n(t)),$n=(e,t,o)=>{if(0===o.length)return[];const n=N(o.slice(1),((t,o)=>t.map((t=>e(o,t))))),r=o[o.length-1].map((e=>t(o.length-1,e)));return n.concat([r])},Gn=(qn={delta:y,edge:Pn,positions:e=>$n(Fn,Vn,e)},Hn={delta:e=>-e,edge:_n,positions:e=>$n(Vn,Fn,e)},e=>"rtl"===(e=>"rtl"===Ye(e,"direction")?"rtl":"ltr")(e)?Hn:qn);var qn,Hn;const Un=e=>Gn(e).edge(e),Kn=le("col"),Qn=(e,t,o,n,r,s)=>e.filter(n).fold((()=>s(((e,t)=>{if(t<0||t>=e.length-1)return w.none();const o=e[t].fold((()=>{const o=(e=>{const t=R.call(e,0);return t.reverse(),t})(e.slice(0,t));return q(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>w.some({value:e,delta:0}))),n=e[t+1].fold((()=>{const o=e.slice(t+1);return q(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>w.some({value:e,delta:1})));return o.bind((e=>n.map((t=>{const o=t.delta+e.delta;return Math.abs(t.value-e.value)/o}))))})(o,t))),(e=>r(e))),Xn=(e,t,o,n)=>{const r=Nn(e),s=Nt(e)?(e=>N(Et(e),(e=>w.from(e.element))))(e):r,l=[w.some(Un(t))].concat(N(((e,t)=>Gn(t).positions(e,t))(r,t),(e=>e.map((e=>e.x))))),c=(a=ot,e=>!a(e));var a;return N(s,((e,t)=>Qn(e,t,l,c,(e=>{if((e=>{const t=En().browser,o=t.isChromium()||t.isFirefox();return!Kn(e)||o})(e))return o(e);{const e=((e,t)=>null!=e?t(e):w.none())(r[t],y);return Qn(e,t,l,c,(e=>n(w.some(ko(e)))),n)}}),n)))},Yn=(e,t,o)=>Xn(e,t,zo,(e=>e.getOrThunk(o.minCellWidth))),Jn=(e,t)=>()=>ye(e)?t(e):parseFloat(Ze(e,"width").getOr("0")),Zn=e=>Bo(e).fold((()=>(e=>{const t=Jn(e,ko),o=v(0);return{width:t,pixelWidth:t,getWidths:(t,o)=>Yn(t,e,o),getCellDelta:o,singleColumnWidth:v([0]),minCellWidth:o,setElementWidth:b,adjustTableWidth:b,isRelative:!0,label:"none"}})(e)),(t=>{return o=e,n=t,null!==Po().exec(n)?(e=>{const t=Jn(e,(e=>parseFloat((e=>Lo(e,ko,No)+"%")(e)))),o=Jn(e,ko);return{width:t,pixelWidth:o,getWidths:(t,o)=>((e,t,o)=>Xn(e,t,Io,(e=>e.fold((()=>o.minCellWidth()),(e=>e/o.pixelWidth()*100)))))(t,e,o),getCellDelta:e=>e/o()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>nt()/o()*100,setElementWidth:jo,adjustTableWidth:o=>{const n=t();jo(e,n+o/100*n)},isRelative:!0,label:"percent"}})(o):(e=>{const t=Jn(e,ko);return{width:t,pixelWidth:t,getWidths:(t,o)=>Yn(t,e,o),getCellDelta:y,singleColumnWidth:(e,t)=>[Math.max(nt(),e+t)-e],minCellWidth:nt,setElementWidth:Mo,adjustTableWidth:o=>{const n=t()+o;Mo(e,n)},isRelative:!1,label:"pixel"}})(o);var o,n})),er=(e,t,o,n)=>{o===n?Ge(e,t):Pe(e,t,o)},tr=(e,t,o)=>{G(Se(e,t)).fold((()=>Vt(e,o)),(e=>Ft(e,o)))},or=(e,t)=>{const o=[],n=[],r=e=>N(e,(e=>{e.isNew&&o.push(e.element);const t=e.element;return Ut(t),W(e.cells,(e=>{e.isNew&&n.push(e.element),er(e.element,"colspan",e.colspan,1),er(e.element,"rowspan",e.rowspan,1),$t(t,e.element)})),t})),s=e=>_(e,(e=>N(e.cells,(e=>(er(e.element,"span",e.colspan,1),e.element))))),l=(t,o)=>{const n=((e,t)=>{const o=Oe(e,t).getOrThunk((()=>{const o=Y.fromTag(t,ue(e).dom);return"thead"===t?tr(e,"caption,colgroup",o):"colgroup"===t?tr(e,"caption",o):$t(e,o),o}));return Ut(o),o})(e,o),l=("colgroup"===o?s:r)(t);Ht(n,l)},c=(t,o)=>{t.length>0?l(t,o):(t=>{Oe(e,t).each(Kt)})(o)},a=[],i=[],m=[],u=[];return W(t,(e=>{switch(e.section){case"thead":a.push(e);break;case"tbody":i.push(e);break;case"tfoot":m.push(e);break;case"colgroup":u.push(e)}})),c(u,"colgroup"),c(a,"thead"),c(i,"tbody"),c(m,"tfoot"),{newRows:o,newCells:n}},nr=(e,t)=>{if(0===e.length)return 0;const o=e[0],n=((e,n)=>{for(let n=0,s=e.length;n<s;n++)if(r=e[n],!t(o.element,r.element))return w.some(n);var r;return w.none()})(e);return n.getOr(e.length)},rr=(e,t)=>{const o=N(e,(e=>N(e.cells,S)));return N(e,((n,r)=>{const s=_(n.cells,((n,s)=>{if(!1===o[r][s]){const m=((e,t,o,n)=>{const r=((e,t)=>e[t])(e,t),s="colgroup"===r.section,l=nr(r.cells.slice(o),n),c=s?1:nr(((e,t)=>N(e,(e=>vt(e,t))))(e.slice(t),o),n);return{colspan:l,rowspan:c}})(e,r,s,t);return((e,t,n,r)=>{for(let s=e;s<e+n;s++)for(let e=t;e<t+r;e++)o[s][e]=!0})(r,s,m.rowspan,m.colspan),[(l=n.element,c=m.rowspan,a=m.colspan,i=n.isNew,{element:l,rowspan:c,colspan:a,isNew:i})]}return[];var l,c,a,i}));return l=n.element,c=s,a=n.section,i=n.isNew,{element:l,cells:c,section:a,isNew:i};var l,c,a,i}))},sr=(e,t)=>q(e.all,(e=>z(e.cells,(e=>ie(t,e.element))))),lr=(e,t,o)=>{const n=(e=>{const t=[],o=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(o);return t})(N(t.selection,(t=>ut(t).bind((t=>sr(e,t))).filter(o))));return Q(n.length>0,n)},cr=(e,t,o,n,r)=>(s,l,c,a)=>{const i=Dt(s),m=w.from(null==a?void 0:a.section).getOrThunk(en),u=t(i,l).map((t=>{const o=((e,t)=>((e,t,o)=>{const n=[];W(e.colgroups,(r=>{const s=[];for(let n=0;n<e.grid.columns;n++){const r=Wt(e,n).map((e=>it(e.element,o,!1))).getOrThunk((()=>it(t.colGap(),!0,!1)));s.push(r)}n.push(mt(r.element,s,"colgroup",o))}));for(let r=0;r<e.grid.rows;r++){const s=[];for(let n=0;n<e.grid.columns;n++){const l=At(e,r,n).map((e=>it(e.element,o,e.isLocked))).getOrThunk((()=>it(t.gap(),!0,!1)));s.push(l)}const l=e.all[r],c=mt(l.element,s,l.section,o);n.push(c)}return n})(e,t,!1))(i,c),n=e(o,t,ie,r(c),m),s=(e=>{const t=I(Ct(e).rows,((e,t)=>(W(t.cells,((t,o)=>{t.isLocked&&(e[o]=!0)})),e)),{}),o=Le(t,((e,t)=>parseInt(t,10)));return F(o)})(n.grid);return{info:t,grid:(l=n.grid,rr(l,ie)),cursor:n.cursor,lockedColumns:s};var l}));return u.bind((e=>{const t=or(s,e.grid),r=w.from(null==a?void 0:a.sizing).getOrThunk((()=>Zn(s))),l=w.from(null==a?void 0:a.resize).getOrThunk(Xo);return o(s,e.grid,e.info,{sizing:r,resize:l,section:m}),n(s),Ge(s,xt),e.lockedColumns.length>0&&Pe(s,xt,e.lockedColumns.join(",")),w.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))},ar=(e,t)=>ut(t.element).bind((t=>sr(e,t))),ir=(e,t)=>lr(e,t,T),mr=(e,t)=>P(t,(t=>((e,t)=>sr(e,t).exists((e=>!e.isLocked)))(e,t))),ur=(e,t)=>((e,t)=>t.mergable)(0,t).filter((t=>mr(e,t.cells))),dr=(e,t)=>((e,t)=>t.unmergable)(0,t).filter((t=>mr(e,t))),hr=["img","br"],pr=e=>{return(t=e,Xt.getOption(t)).filter((e=>0!==e.trim().length||e.indexOf("\xa0")>-1)).isSome()||A(hr,J(e));var t},gr={scope:["row","col"]},fr=e=>()=>{const t=Y.fromTag("td",e.dom);return $t(t,Y.fromTag("br",e.dom)),t},wr=e=>()=>Y.fromTag("col",e.dom),br=e=>()=>Y.fromTag("colgroup",e.dom),vr=e=>()=>Y.fromTag("tr",e.dom),yr=(e,t,o)=>{const n=Jo(e,t);return We(o,((e,t)=>{null===e?Ge(n,t):Pe(n,t,e)})),n},Cr=(e,t,o)=>{return(n=e,((e,t)=>{const o=e=>{for(let n=0;n<e.childNodes.length;n++){const r=Y.fromDom(e.childNodes[n]);if(t(r))return w.some(r);const s=o(e.childNodes[n]);if(s.isSome())return s}return w.none()};return o(e.dom)})(n,pr)).map((n=>{const r=o.join(","),s=xe(n,r,(t=>ie(t,e)));return B(s,((e,t)=>{const o=Yo(t,!1);return Ge(o,"contenteditable"),$t(e,o),o}),t)})).getOr(t);var n},xr=(e,t,o)=>{const n=(e,t)=>{((e,t)=>{const o=e.dom,n=t.dom;Qe(o)&&Qe(n)&&(n.style.cssText=o.style.cssText)})(e.element,t),et(t,"height"),1!==e.colspan&&et(t,"width")};return{col:o=>{const r=Y.fromTag(J(o.element),t.dom);return n(o,r),e(o.element,r),r},colgroup:br(t),row:vr(t),cell:r=>{const s=Y.fromTag(J(r.element),t.dom),l=o.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=l.length>0?Cr(r.element,s,l):s;return $t(c,Y.fromTag("br")),n(r,s),((e,t)=>{We(gr,((o,n)=>$e(e,n).filter((e=>A(o,e))).each((e=>Pe(t,n,e)))))})(r.element,s),e(r.element,s),s},replace:yr,colGap:wr(t),gap:fr(t)}},Sr=e=>Dt(e).grid,Tr=(e,t=!1)=>{return ye(e)?e.dom.isContentEditable:(o=e,ke(o,"[contenteditable]")).fold(v(t),(e=>"true"===Rr(e)));var o},Rr=e=>e.dom.contentEditable,Dr=(e,t,o,n,r)=>N(e,(e=>{const s=t>0&&t<e.cells.length&&n(yt(e,t-1),yt(e,t)),l=((e,t,o,n,r,s,l)=>{if("colgroup"!==o&&n)return vt(e,t);{const t=vt(e,r);return it(l(t.element,s),!0,!1)}})(e,t,e.section,s,o,n,r);return((e,t,o)=>((e,t,o)=>{const n=e.cells,r=n.slice(0,t),s=n.slice(t),l=r.concat(o).concat(s);return bt(e,l)})(e,t,[o]))(e,t,l)})),Or={...(e=>{if(!i(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],o={};return W(e,((n,r)=>{const s=Ee(n);if(1!==s.length)throw new Error("one and only one name per case");const l=s[0],c=n[l];if(void 0!==o[l])throw new Error("duplicate key detected:"+l);if("cata"===l)throw new Error("cannot have a case named cata (sorry)");if(!i(c))throw new Error("case arguments must be an array");t.push(l),o[l]=(...o)=>{const n=o.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+l+". Expected "+c.length+" ("+c+"), got "+n);return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[r].apply(null,o)},match:e=>{const n=Ee(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!P(t,(e=>A(n,e))))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[l].apply(null,o)},log:e=>{console.log(e,{constructors:t,constructor:l,params:o})}}}})),o})([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},Ar=(e,t)=>Nt(e)?((e,t)=>{const o=Et(e);return N(o,((e,o)=>({element:e.element,width:t[o],colspan:e.colspan})))})(e,t):((e,t)=>{const o=(e=>_(e.all,(e=>e.cells)))(e);return N(o,(e=>{const o=((e,t,o)=>{let n=0;for(let r=e;r<t;r++)n+=void 0!==o[r]?o[r]:0;return n})(e.column,e.column+e.colspan,t);return{element:e.element,width:o,colspan:e.colspan}}))})(e,t),kr=(e,t,o)=>{const n=Ar(e,t);W(n,(e=>{o.setElementWidth(e.element,e.width)}))},Er=e=>I(e,((e,t)=>k(e,(e=>e.column===t.column))?e:e.concat([t])),[]).sort(((e,t)=>e.column-t.column)),Nr=e=>Tr(e,!0),Wr=(e,t,o)=>((e,t)=>({grid:e,cursor:t}))(e,((e,t,o)=>{var n,r;const s=Ct(e).rows;return w.from(null===(r=null===(n=s[t])||void 0===n?void 0:n.cells[o])||void 0===r?void 0:r.element).filter(Nr).orThunk((()=>(e=>q(e,(e=>q(e.cells,(e=>{const t=e.element;return Q(Nr(t),t)})))))(s)))})(e,t,o)),Lr=(e,t,o,n)=>((e,t,o,n,r)=>{const s=Ot(t),l=n.getWidths(s,n),c=n.pixelWidth(),{newSizes:a,delta:i}=r.calcRedestributedWidths(l,c,o.pixelDelta,n.isRelative);kr(s,a,n),n.adjustTableWidth(i)})(0,t,o,n.sizing,n.resize),Mr=(e,t)=>{const o=Nn(e),n=Er(t);return I(n,((e,t)=>e+o[t.column].map(Eo).getOr(0)),0)},jr=cr(((e,t,o,n)=>{const r=t.detail,s=r.column,l=r.column,c=Dr(e,l,s,o,n.getOrInit);return Wr(c,r.row,l)}),((e,t)=>ar(e,t).filter((e=>!k([e],(e=>0===e.column&&e.isLocked)))).map((t=>({detail:t,pixelDelta:Mr(e,[t])})))),Lr,b,qo),Br=cr(((e,t,o,n)=>{const r=Er(t.details),s=((e,t)=>_(e,(e=>{const o=e.cells,n=B(t,((e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e),o);return n.length>0?[mt(e.element,n,e.section,e.isNew)]:[]})))(e,N(r,(e=>e.column))),l=s.length>0?s[0].cells.length-1:0;return Wr(s,r[0].row,Math.min(r[0].column,l))}),((e,t)=>((e,t)=>lr(e,t,(e=>!e.isLocked)))(e,t).map((t=>({details:t,pixelDelta:-Mr(e,t)})))),Lr,(e=>{0===dt(e).length&&Kt(e)}),qo),Ir=(e,t)=>{const o=Ve(e,t);return void 0===o||""===o?[]:o.split(" ")},zr=e=>void 0!==e.dom.classList,_r=e=>e.dom.textContent,Pr=le("th"),Fr=(e,t)=>e&&t?"sectionCells":e?"section":"cells",Vr=e=>{const t=M(e,(e=>Pr(e.element)));return 0===t.length?w.some("td"):t.length===e.length?w.some("th"):w.none()},$r=e=>{const t=N(e,(e=>(e=>{const t="thead"===e.section,o=H(Vr(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:Fr(t,o)}:{type:"body"}})(e).type)),o=A(t,"header"),n=A(t,"footer");if(o||n){const e=A(t,"body");return!o||e||n?o||e||!n?w.none():w.some("footer"):w.some("header")}return w.some("body")},Gr={structure:!1,style:!0},qr={structure:!0,style:!1},Hr=(e,t,o)=>({value:t+1}),Ur=(e,t,o)=>{const n="A".charCodeAt(0),r=[];let s=t;for(;s>=0;)r.push(String.fromCharCode(n+s%26)),s=Math.floor(s/26)-1;return{value:r.reverse().join("")}},Kr=e=>e.options.get("advtable_value_series"),Qr=e=>{const t=parseFloat(e);return isNaN(t)?w.none():w.some(t)},Xr=(e,t)=>e<t?-1:e>t?1:0,Yr=(e,t)=>U(Qr(e),Qr(t),Xr).getOrThunk((()=>((e,t)=>e.localeCompare(t))(e,t))),Jr=e=>{const t=(e=>w.from(e.options.get("table_clone_elements")))(e),o=(o,r,s,l)=>(c,a,i,m,u=!1)=>{const d=Y.fromDom(e.getDoc()),h=xr(s,d,t);return r(c)?o(c,a,h).bind((t=>{W(t.newRows,(t=>{((e,t)=>{e.dispatch("NewRow",{node:t})})(e,t.dom)})),W(t.newCells,(t=>{((e,t)=>{e.dispatch("NewCell",{node:t})})(e,t.dom)}));const o=((t,o,r,s)=>{const l=r.filter((e=>ye(e)&&n(e))).or(o.cursor);return l.fold((()=>{const o=dt(t);return $(o).filter(ye).map((o=>{const n=e.dom.createRng();return n.selectNode(o.dom),s&&(e.model.table.clearSelectedCells(t.dom),e.selection.setRng(n),Pe(o,"data-mce-selected","1")),n}))}),(o=>{const n=e.dom.createRng(),r=xo(So,o);return n.setStart(r.element.dom,r.offset),n.setEnd(r.element.dom,r.offset),s&&(e.model.table.clearSelectedCells(t.dom),e.selection.setRng(n)),w.some(n)}))})(c,t,i,m);return ye(c)&&((e=>{Ge(e,"data-mce-style");const t=e=>Ge(e,"data-mce-style");W(dt(e),t),W(ht(e),t),W(gt(e),t)})(c),u||((e,t,o)=>{e.dispatch("TableModified",{...o,table:t})})(e,c.dom,l)),o.map((e=>({rng:e,effect:l})))})):w.none()},n=e=>Tr(e,!0),r=(e,t,o)=>((e,t)=>({grid:e,cursor:t}))(e,((e,t,o)=>{var r,s;const l=Ct(e).rows;return w.from(null===(s=null===(r=l[t])||void 0===r?void 0:r.cells[o])||void 0===s?void 0:s.element).filter(n).orThunk((()=>(e=>q(e,(e=>q(e.cells,(e=>{const t=e.element;return Q(n(t),t)})))))(l)))})(e,t,o)),s=(e,t,o,n)=>{const{cols:r,rows:s}=Ct(e),l=j(s,(e=>e.section)),c=N(l,(e=>j(e,(e=>{const o=vt(e,t).element;return J(o)})))),a=_(c,(e=>_(e,(e=>{const r=vt(e[0],t).element;return"th"===J(r)?e:(e=>{const r=N(e,(e=>{const o=vt(e,t).element;return{row:e,text:w.from(_r(o)).getOr("")}})),s=F(r,((e,t)=>{const r=o(e.text,t.text);return n?r:-1*r}));return N(s,(e=>e.row))})(e)}))));return[...r,...a]},l=(e,t,o,n)=>{const{cols:r,rows:s}=Ct(e),l=s[t].cells,c=N(l,(e=>{const t=e.element;return w.from(_r(t)).getOr("")})),a=le("th"),i=N(s,(e=>{const t=N(e.cells,((e,t)=>({cell:e,column:t,reference:l[t],referenceText:c[t]})));return{...e,zippedCells:t}})),m=N(i,(e=>{const t=j(e.zippedCells,(e=>{const t=e.reference.element;return J(t)})),r=_(t,(e=>{const t=e[0].reference.element;if(a(t))return N(e,(e=>e.cell));{const{pass:t,fail:r}=L(e,(e=>e.cell.isLocked)),s=F(r,((e,t)=>{const r=o(e.referenceText,t.referenceText);return n?r:-1*r})),l=I(t,((e,t)=>{const o=t.column,n=e.slice(0,o),r=e.slice(o);return n.concat([t]).concat(r)}),s);return N(l,(e=>e.cell))}}));return mt(e.element,r,e.section,e.isNew)}));return[...r,...m]},u=s,d=l,h=(e,t,o,n,r)=>{const{cols:s,rows:l}=Ct(e),c=l.slice(0,t),a=[...s,...l.slice(t,o+1)];return{beforeRows:c,afterRows:l.slice(o+1,e.length),selectionGridBefore:a.map((e=>({...e,cells:e.cells.slice(0,n)}))),selectionGrid:a.map((e=>({...e,cells:e.cells.slice(n,r+1)}))),selectionGridAfter:a.map((e=>({...e,cells:e.cells.slice(r+1,e.cells.length)})))}},p=(e,t)=>{const o=N(t,((t,o)=>{const n=e.selectionGridBefore[o].cells,r=e.selectionGridAfter[o].cells;return{...t,cells:n.concat(t.cells).concat(r)}})),{cols:n,rows:r}=Ct(o);return[...n,...e.beforeRows,...r,...e.afterRows]},g=(e,t,o,n,r,l,c,a)=>{const i=h(e,o,n,r,l),m=s(i.selectionGrid,t-r,c,a);return p(i,m)},C=(e,t,o,n,r,s,c,a)=>{const i=h(e,o,n,r,s),m=l(i.selectionGrid,t-o,c,a);return p(i,m)},x=e=>I(e,((e,t)=>k(e,(e=>e.row===t.row))?e:e.concat([t])),[]).sort(((e,t)=>e.row-t.row)),S=e=>I(e,((e,t)=>k(e,(e=>e.column===t.column))?e:e.concat([t])),[]).sort(((e,t)=>e.column-t.column)),R=e=>I(e,((e,t)=>k(e,(e=>ie(e.element,t.element)))?e:e.concat([t])),[]),D=e=>{const t=a(e.attributes)?Le(e.attributes,((e,t)=>m(e)?e=>Ge(e,t):o=>Pe(o,t,e))):[];return[...t,...((e,t)=>{if(i(e)){for(let o=0,n=e.length;o<n;++o)if(!t(e[o]))return!1;return!0}return!1})(e.classes,c)?N(e.classes,(e=>t=>((e,t)=>{zr(e)?e.dom.classList.add(t):((e,t)=>{((e,t,o)=>{const n=Ir(e,t).concat([o]);Pe(e,t,n.join(" "))})(e,"class",t)})(e,t)})(t,e))):[],t=>{const o=_r(t)||"",n=(r=e.value,f(r)?String(r):c(r)?r:void 0);var r;const s=c(n)?n:o;Ke(s)?((e,t)=>{const o=ue(e).dom,n=Y.fromDom(o.createDocumentFragment()),r=((e,t)=>{const o=(t||document).createElement("div");return o.innerHTML=e,we(Y.fromDom(o))})(t,o);Ht(n,r),Ut(e),$t(e,n)})(t,"<br>"):((e,t)=>{e.dom.textContent=t})(t,s)}]},O=(e,t,o,n,r,s,l,c)=>{let a;W(t,((t,i)=>{const m=t.element,u={sectionType:s(i),cellType:J(m),getRowType:l(i),getColType:c(i),classes:(p=m,zr(p)?(e=>{const t=e.dom.classList,o=new Array(t.length);for(let e=0;e<t.length;e++){const n=t.item(e);null!==n&&(o[e]=n)}return o})(p):(e=>Ir(e,"class"))(p)),prev:null==a?void 0:a.raw,direction:o},d=e(u,n(i),r(i)),h=D(d);var p;W(h,(e=>e(m))),a=d}))},A=(e,t,o,n,s)=>{const l=g(e,s,0,e.length,s,s,o,n);return r(l,t[0].row,t[0].column)},E=(e,t,o,n,s)=>{const l=x(t),c=S(t),a=g(e,s,l[0].row,l[l.length-1].row,c[0].column,c[c.length-1].column,o,n);return r(a,t[0].row,t[0].column)},M=(e,t,o,n,s)=>{const l=u(e,s,o,n);return r(l,t.row,t.column)},B=(e,t,o,n,s)=>{const l=C(e,s,s,s,0,e[t[0].row].cells.length,o,n);return r(l,t[0].row,t[0].column)},z=(e,t,o,n,s)=>{const l=x(t),c=S(t),a=C(e,s,l[0].row,l[l.length-1].row,c[0].column,c[c.length-1].column,o,n);return r(a,t[0].row,t[0].column)},P=(e,t,o,n,s)=>{const l=d(e,s,o,n);return r(l,t.row,t.column)},V=(e,t,o,n)=>{const s=Ct(e).rows,l=N(s,(e=>vt(e,n))),c=R(l),a=wo((()=>Vr(c).getOr("")));return O(o,c,"column",y,v(n),(e=>s[e].section),(e=>wo((()=>{const t=s[e];return $r([{cells:t.cells,section:t.section}]).getOr("")}))),(e=>a)),r(e,t.row,t.column)},G=(e,t,o,n)=>{const s=Ct(e).rows,l=s[n],c=R(l.cells),a=wo((()=>$r([{cells:l.cells,section:l.section}]).getOr("")));return O(o,c,"row",v(n),y,(e=>l.section),(e=>a),(e=>wo((()=>{const t=N(s,(t=>vt(t,e)));return Vr(t).getOr("")})))),r(e,t.row,t.column)},H=(e,t,o,n,r)=>(s,l,c)=>{const a=cr(((r,s)=>e(r,s,t,o,n)),r,b,b,qo);return a(s,l,c)},U=(e,t,o,n)=>(r,s,l)=>{const c=cr(((n,r)=>e(n,r,t,o)),n,b,b,qo);return c(r,s,l)},K=o(jr,T,Fo,qr),X=o(Br,(t=>0==("table"===J(Lt(e)))||Sr(t).columns>1),b,qr);return{sortColumnRowsAsc:e=>o(H(A,Yr,!0,e,ir),T,b,qr),sortColumnRowsDesc:e=>o(H(A,Yr,!1,e,ir),T,b,qr),sortSelectionRowsAsc:e=>o(H(E,Yr,!0,e,ir),T,b,qr),sortSelectionRowsDesc:e=>o(H(E,Yr,!1,e,ir),T,b,qr),sortTableRowsAsc:e=>o(H(M,Yr,!0,e,ar),T,b,qr),sortTableRowsDesc:e=>o(H(M,Yr,!1,e,ar),T,b,qr),sortRowColumnsAsc:e=>o(H(B,Yr,!0,e,ir),T,b,qr),sortRowColumnsDesc:e=>o(H(B,Yr,!1,e,ir),T,b,qr),sortSelectionColumnsAsc:e=>o(H(z,Yr,!0,e,ir),T,b,qr),sortSelectionColumnsDesc:e=>o(H(z,Yr,!1,e,ir),T,b,qr),sortTableColumnsAsc:e=>o(H(P,Yr,!0,e,ar),T,b,qr),sortTableColumnsDesc:e=>o(H(P,Yr,!1,e,ar),T,b,qr),insertColumnBefore:K,deleteColumn:X,populateColumn:(e,t)=>o(U(V,t,e,ar),T,b,Gr),populateRow:(e,t)=>o(U(G,t,e,ar),T,b,Gr)}},Zr="data-snooker-locked-cols",es=e=>$e(e,Zr).map((e=>_(e.split(","),(e=>{const t=parseInt(e,10);return isNaN(t)?[]:[t]})))).getOr([]),ts=(e,t)=>Pe(e,Zr,F(t).join(",")),os=(e,t)=>{const o=es(e);A(o,t)||ts(e,o.concat([t]))},ns=(e,t)=>{const o=es(e);ts(e,M(o,(e=>t!==e)))},rs="data-snooker-col-series",ss=e=>$e(e,rs),ls=(e,t)=>H(ss(e).map((e=>e.toLowerCase())),t.toLowerCase()),cs=e=>((e,t)=>{const o=e.dom;return!(!o||!o.hasAttribute)&&o.hasAttribute("data-snooker-col-series")})(e),as=e=>{const t=Zn(e),o=Dt(e),n=At(o,0,0).bind((e=>{const t=e.element;return Do(Ye(t,"width"),["fixed"])})).map((e=>28-e.value)).getOr(0);((e,t,o,n,r)=>{const s=Dt(e),l=r.getCellDelta(t),c=r.getWidths(s,r),a=0==s.grid.columns-1,i=n.clampTableDelta(c,0,l,r.minCellWidth(),a),m=((e,t,o,n,r)=>{const s=e.slice(0),l=((e,t)=>0===e.length?Or.none():1===e.length?Or.only(0):0===t?Or.left(0,1):t===e.length-1?Or.right(t-1,t):t>0&&t<e.length-1?Or.middle(t-1,t,t+1):Or.none())(e,t),c=v(N(s,v(0)));return l.fold(c,(e=>n.singleColumnWidth(s[e],o)),((e,t)=>r.calcLeftEdgeDeltas(s,e,t,o,n.minCellWidth(),n.isRelative)),((e,t,l)=>r.calcMiddleDeltas(s,e,t,l,o,n.minCellWidth(),n.isRelative)),((e,t)=>r.calcRightEdgeDeltas(s,e,t,o,n.minCellWidth(),n.isRelative)))})(c,0,i,r,n),u=N(m,((e,t)=>e+c[t]));kr(s,u,r),n.resizeTable(r.adjustTableWidth,i,a)})(e,n,0,Xo(),t)},is=(e,t,o,n,r)=>{((e,t)=>{const o=k(es(e),(e=>0===e));o&&ns(e,0),t(),o&&os(e,1)})(e,(()=>{o.column(0,t.insertColumnBefore,!0,!0),as(e),ms(e,t,o,n,r)}))},ms=(e,t,o,n,r)=>{o.table(e,0,0,t.populateColumn(0,((e,t,o)=>{const n=r.generator(e,t,o);return{raw:n,value:n.value,classes:n.classes,attributes:{contenteditable:"false",...n.attributes,"data-mce-resize":!1===r.resizable?"false":null}}})),!0,!0),((e,t)=>{Pe(e,rs,t)})(e,n),os(e,0)},us=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},ds=e=>pt(jt(e),Mt(e)),hs=(e,t)=>{e.execCommand("mceTableToggleSeries",!1,t)},ps=(e,t,o)=>t.onSetupCellOrRowToggle((()=>((e,t)=>ds(e).exists((e=>Ke(t)?!cs(e):ls(e,t))))(e,o))),gs=(e,t)=>({type:"togglemenuitem",text:"None",onAction:()=>{(e=>ds(e).bind(ss))(e).each((t=>{hs(e,{name:t})}))},onSetup:ps(e,t,"")}),fs=(e,t,o,n,r)=>({type:"togglemenuitem",text:o,value:n,icon:r,onAction:()=>hs(e,{name:n}),onSetup:ps(e,t,n)}),ws=(e,t,o)=>Le(o,((o,n)=>{const r=w.from(o.title).getOrThunk((()=>{return""===(e=n)?"":e.charAt(0).toUpperCase()+e.substring(1);var e}));return fs(e,t,r,n)})),bs=e=>t=>{const o=t.getData();t.close(),e.undoManager.transact((()=>{e.execCommand("mceSortTableAdvanced",!1,o),e.focus(),e.addVisual()}))},vs=e=>{const t={type:"selectbox",name:"sortby",label:"Sort by",items:[{text:"Column",value:"column"},{text:"Row",value:"row"}]},o=us(w.none()),n=t=>({type:"selectbox",name:"roworcol",label:"column"===t?"Column":"Row",items:"column"===t?(()=>{const t=o.get().getOrDie("state must be present"),n=t.limit?t.finishCol+1-t.startCol:t.columns;return E(n,(o=>{const n=t.limit?t.startCol:0,r=(e=>{let t=e,o="";for(;Math.floor(t)>0;)--t,o+=String.fromCharCode("A".charCodeAt(0)+t%26),t/=26;return o.split("").reverse().join("")})(o+n+1);return{text:e.translate(["Column {0}",r]),value:`${o+n}`}}))})():(()=>{const t=o.get().getOrDie("state must be present"),n=t.limit?t.finishRow+1-t.startRow:t.rows;return E(n,(o=>{const n=t.limit?t.startRow:0,r=(o+n+1).toString();return{text:e.translate(["Row {0}",r]),value:`${o+n}`}}))})()}),r=e=>({type:"selectbox",name:"sort",label:"Sort",items:["column"===e?{text:"Column",value:"column"}:{text:"Row",value:"row"},{text:"Selection",value:"selection"},{text:"Table",value:"table"}]}),s={type:"selectbox",name:"order",label:"Order",items:[{text:"Ascending",value:"ascending"},{text:"Descending",value:"descending"}]},l=e=>({type:"panel",items:[{type:"grid",columns:2,items:[t,n(e),r(e),s]}]}),c=e=>({title:"Advanced Sort",size:"normal",body:l(e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"sort",text:"Sort",primary:!0}]}),a=()=>{o.set(w.none())},i=(t,n)=>{if("sortby"===n.name){const n=t.getData(),l=(r=n,s=o.get().getOrDie("state must be present"),"column"===r.sortby?{sortby:"column",roworcol:`${s.startCol}`,sort:"row"===r.sort?"column":r.sort,order:r.order}:{sortby:"row",roworcol:`${s.startRow}`,sort:"column"===r.sort?"row":r.sort,order:r.order}),m={...c(n.sortby),onChange:i,onClose:a,onSubmit:bs(e),initialData:l};t.redial(m),t.focus("sortby")}var r,s};go(jt(e)).each((t=>{pt(t,Mt(e)).each((n=>{const r=uo(fo(e),n,t),s=t=>{o.set(w.some(t));const n={sortby:"column",roworcol:`${t.startCol}`,sort:"column",order:"ascending"},r={...c("column"),onChange:i,onClose:a,onSubmit:bs(e),initialData:n};e.windowManager.open(r)},l=Sr(n);r.mergable.fold((()=>{zt(n,t,t).each((e=>{const t={...e,...l,limit:!1};s(t)}))}),(e=>{const t={...e.bounds,...l,limit:!0};s(t)}))}))}))},ys=(e,t,o,n)=>{const r=e=>"selection"===e,s=e=>"ascending"===e,l=t=>pt(t,Mt(e)),a=()=>go(jt(e),Mt(e)).bind((e=>l(e).bind((t=>zt(t,e,e))))),i=()=>a().map((e=>e.startCol)),m=()=>a().map((e=>e.startRow));e.addCommand("mceSortTableByColumnAsc",(()=>{i().each((e=>{o.selection(t.sortTableRowsAsc(e))}))})),e.addCommand("mceSortTableByColumnDesc",(()=>{i().each((e=>{o.selection(t.sortTableRowsDesc(e))}))})),e.addCommand("mceSortTableByRowAsc",(()=>{m().each((e=>{o.selection(t.sortTableColumnsAsc(e))}))})),e.addCommand("mceSortTableByRowDesc",(()=>{m().each((e=>{o.selection(t.sortTableColumnsDesc(e))}))})),e.addCommand("mceSortTableAdvanced",((e,n)=>(e=>{const n=parseInt(e.roworcol,10);"column"===e.sortby?((e,n)=>{(e=>"column"===e)(e.sort)?s(e.order)?o.selection(t.sortColumnRowsAsc(n)):o.selection(t.sortColumnRowsDesc(n)):r(e.sort)?s(e.order)?o.selection(t.sortSelectionRowsAsc(n)):o.selection(t.sortSelectionRowsDesc(n)):s(e.order)?o.selection(t.sortTableRowsAsc(n)):o.selection(t.sortTableRowsDesc(n))})(e,n):((e,n)=>{(e=>"row"===e)(e.sort)?s(e.order)?o.selection(t.sortRowColumnsAsc(n)):o.selection(t.sortRowColumnsDesc(n)):r(e.sort)?s(e.order)?o.selection(t.sortSelectionColumnsAsc(n)):o.selection(t.sortSelectionColumnsDesc(n)):s(e.order)?o.selection(t.sortTableColumnsAsc(n)):o.selection(t.sortTableColumnsDesc(n))})(e,n)})(n))),e.addCommand("mceAdvancedTableSort",(()=>vs(e))),e.addCommand("mceTableToggleSeries",((r,s)=>{const a=w.from(s.name).filter(c),i=l(jt(e));U(a,i,((e,r)=>{ls(r,e)?((e,t,o)=>{ns(e,0),(e=>{Ge(e,rs)})(e),o.column(0,t.deleteColumn,!0,!0)})(r,t,o):Be(n,e).each((n=>{(cs(r)?ms:is)(r,t,o,e,n)}))}))}))},Cs=e=>{const t=us(w.none()),o=us([]);let n=w.none();const r=le("caption"),s=()=>po(jt(e),Mt(e)).bind((t=>K(U(pt(t),po((e=>Y.fromDom(e.selection.getEnd()))(e),Mt(e)).bind(pt),((o,n)=>ie(o,n)?r(t)?w.some(mo(t)):w.some(uo(fo(e),o,t)):w.none()))))),l=e=>pt(e.element).map((t=>{const o=Dt(t),n=ir(o,e).getOr([]),r=I(n,((e,t)=>(t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=o.grid.columns&&(e.onLast=!0)),e)),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ur(o,e).isSome(),unmergeable:dr(o,e).isSome(),locked:r}})),c=()=>{t.set(wo(s)()),n=t.get().bind(l),W(o.get(),(e=>e()))},a=e=>(e(),o.set(o.get().concat([e])),()=>{o.set(M(o.get(),(t=>t!==e)))}),i=(e,o)=>a((()=>t.get().fold((()=>{e.setEnabled(!1)}),(t=>{e.setEnabled(!o(t))}))));return e.on("NodeChange ExecCommand TableSelectorChange",c),{onSetupTable:e=>i(e,(e=>!1)),onSetupCellOrRow:e=>i(e,(e=>r(e.element))),onSetupColumn:e=>t=>i(t,(t=>r(t.element)||(e=>n.exists((t=>t.locked[e])))(e))),onSetupCellOrRowToggle:e=>o=>((e,o,n)=>a((()=>t.get().fold((()=>{e.setEnabled(!1),e.setActive(!1)}),(t=>{e.setEnabled(!(e=>r(e.element))(t)),e.setActive(n(t))})))))(o,0,e),resetTargets:c,targets:()=>t.get()}};tinymce.PluginManager.requireLangPack("advtable","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hi,hr,hu_HU,id,it,ja,kk,ko_KR,ms,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,vi,zh_CN,zh_TW"),tinymce.PluginManager.add("advtable",(e=>{if(((e,o)=>!!e&&-1===((e,o)=>{const n=t(e.major,o.major);if(0!==n)return n;const r=t(e.minor,o.minor);if(0!==r)return r;const s=t(e.patch,o.patch);return 0!==s?s:0})((e=>n((e=>[e.majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."))(e)))(e),n(o)))(tinymce,"6.0.0"))return console.error("Please use Advanced Tables with TinyMCE 6.0.0 or later."),{};(e=>{(0,e.options.register)("advtable_value_series",{processor:"object",default:{numeric:{title:"Numeric",update:!0,resizable:!1,generator:Hr},alpha:{title:"Alpha",update:!0,resizable:!1,generator:Ur}}})})(e);const o=Jr(e),r=Cs(e),s=(e=>{const t=t=>{e.focus()},o=t=>pt(t,Mt(e)),n=(n,r,s,l,c)=>{go(jt(e)).each((e=>{o(e).each((o=>{const a=Dt(o),i=(e,t)=>kt(a,e,ie).map((e=>e[t])),m=n.orThunk((()=>i(e,"row"))),u=r.orThunk((()=>i(e,"column"))),d=K(U(m,u,((e,t)=>At(a,e,t).map((e=>e.element)))));d.bind((t=>{const n=mo(t);return s(o,n,Q(l,e),!0,c)})).each(t)}))}))};return{selection:(n,r)=>{go(jt(e)).each((s=>{o(s).each((o=>{const l=uo(fo(e),o,s);n(o,l,w.none(),!0,r).each(t)}))}))},row:(e,t,o,r)=>n(w.some(e),w.none(),t,o,r),column:(e,t,o,r)=>n(w.none(),w.some(e),t,o,r),table:(o,n,r,s,l,c)=>{const a=Dt(o),i=At(a,n,r).map((e=>e.element)),m=go(jt(e)),u=m.bind((e=>kt(a,e,ie))).isSome(),d=i.bind((e=>{const t=mo(e),n=u&&l?m:w.none();return s(o,t,n,u,c)}));d.each(t)}}})(e),l=Kr(e);return ys(e,o,s,l),((e,t,o,n)=>{const r=()=>pt(jt(e),Mt(e)),s=(s,l=T)=>{const c=ss(s),a=c.bind((e=>Be(n,e)));U(c,a,((n,c)=>{1===Dt(s).grid.columns?r().exists((e=>ie(s,e)))?e.execCommand("mceTableDelete"):e.undoManager.transact((()=>{Kt(s)})):!0===c.update&&l()&&ms(s,t,o,n,c)}))};e.on("TableModified",(e=>{const t=Y.fromDom(e.table);s(t,(()=>!1!==e.structure))})),e.on("PreInit",(()=>{((e,t)=>{const o=e=>{const t=[];return h(e)?t:((e=>"thead"===e.name||"tbody"===e.name||"tfoot"===e.name)(e)?t.push(...o(e.firstChild)):"tr"===e.name&&t.push(e),t.concat(o(e.next)))},n=e=>o(e.firstChild);e.parser.addAttributeFilter(rs,(e=>{var o;for(const r of e)if("table"===r.name){const e=r.attr(rs);if(!1===(null===(o=t[e])||void 0===o?void 0:o.resizable)){const e=n(r);for(const t of e)p(t.firstChild)&&t.firstChild.attr("data-mce-resize","false")}}}))})(e,n)})),e.on("init",(()=>{const t=()=>{const t=go(jt(e),Mt(e));return e.selection.isCollapsed()&&t.exists((t=>e.dom.isEmpty(t.dom)))};e.on("ExecCommand",(e=>{const o=e.command.toLowerCase();"delete"!==o&&"forwarddelete"!==o||!t()||r().each(s)}),!0),e.on("keyup",(e=>{const o=e.keyCode;8!==o&&46!==o||!t()||r().each(s)}))}))})(e,o,s,l),e.hasPlugin("table")&&(((e,t)=>{const o=(t,o)=>()=>e.execCommand(t,!1,o),n=t.onSetupCellOrRow,r=[{type:"menuitem",text:"Sort table by column ascending",onAction:o("mceSortTableByColumnAsc"),onSetup:n},{type:"menuitem",text:"Sort table by column descending",onAction:o("mceSortTableByColumnDesc"),onSetup:n},{type:"separator"},{type:"menuitem",text:"Advanced sort...",onAction:()=>vs(e),onSetup:n}];e.ui.registry.addNestedMenuItem("advtablesort",{type:"nestedmenuitem",text:"Sort",getSubmenuItems:v(r)});const s=Kr(e);if(1===je(s)){const o=Ee(s)[0];e.ui.registry.addToggleMenuItem("advtablerownumbering",fs(e,t,"Row numbering",o,"table-row-numbering"))}else ze(s)||e.ui.registry.addNestedMenuItem("advtablerownumbering",{type:"nestedmenuitem",text:"Row numbering",icon:"table-row-numbering",getSubmenuItems:()=>{const o=gs(e,t),n=ws(e,t,s);return[o].concat(n)}})})(e,r),((e,t)=>{const o=Kr(e);if(1===je(o)){const n=Ee(o)[0];e.ui.registry.addToggleButton("advtablerownumbering",{type:"togglebutton",tooltip:"Row numbering",icon:"table-row-numbering",onAction:()=>hs(e,{name:n}),onSetup:ps(e,t,n)})}else ze(o)||e.ui.registry.addMenuButton("advtablerownumbering",{type:"menubutton",icon:"table-row-numbering",tooltip:"Row numbering",fetch:n=>{const r=gs(e,t),s=ws(e,t,o);return n([r].concat(s))},onSetup:t.onSetupCellOrRow})})(e,r)),{}}))}();